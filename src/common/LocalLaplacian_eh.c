#ifdef HAVE_CONFIG_H
#include "config.h"
#endif
#include <stdlib.h>
#include "develop/imageop.h"
#include "common/gaussian.h"
#include "LocalLaplacian_eh.h"

/* 
 Copyright (c) 1995-2010, Stanford University
* All rights reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions are met:
*     * Redistributions of source code must retain the above copyright
*       notice, this list of conditions and the following disclaimer.
*     * Redistributions in binary form must reproduce the above copyright
*       notice, this list of conditions and the following disclaimer in the
*       documentation and/or other materials provided with the distribution.
*     * Neither the name of Stanford University nor the
*       names of its contributors may be used to endorse or promote products
*       derived from this software without specific prior written permission.
*
* THIS SOFTWARE IS PROVIDED BY STANFORD UNIVERSITY ''AS IS'' AND ANY
* EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
* WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
* DISCLAIMED. IN NO EVENT SHALL STANFORD UNIVERSITY BE LIABLE FOR ANY
* DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
* (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
* LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
* ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

/*
This module modifies contrast at various scales.

It is based on ImageStack's implementation of Fast and Robust Pyramid-based Image Processing by Aubry et al,
which is an acceleration of Local Laplacian Filters by Paris et al.

The first argument specifies how much of an effect to apply:
0 gives no effect, 
-1 produces a piecewise flattening,
1 produces a moderate amount of contrast enhancement.

The second argument specifies how the effect should change with respect to scale:
0 applies the same effect at all scales, 
-1 applies the effect only at coarse scales, 
1 applies the effect only at fine scales. 

Values larger than one actually reverse the effect at fine or coarse scales. 
In fact alpha=1 beta=2 is an effective tone-mapper because it amplifies contrast 
at fine scales and reduces it at coarse scales.
*/

typedef struct _loclap_image_t
{
  float *im;
  int width, height;
} _loclap_image_t;


static float _loclap_fastexp[4096] = {4.5399929762484854e-05f, 4.5622151198316411e-05f, 4.584546035315549e-05f, 4.606986255111782e-05f, 4.6295363142379343e-05f, 4.6521967503303795e-05f, 4.6749681036570883e-05f, 4.6978509171305104e-05f, 4.7208457363205169e-05f, 4.7439531094674096e-05f, 4.7671735874949888e-05f, 4.7905077240236928e-05f, 4.813956075383795e-05f, 4.8375192006286674e-05f, 4.8611976615481098e-05f, 4.8849920226817449e-05f, 4.9089028513324769e-05f, 4.9329307175800172e-05f, 4.9570761942944781e-05f, 4.9813398571500273e-05f, 5.0057222846386166e-05f, 5.0302240580837729e-05f, 5.0548457616544577e-05f, 5.0795879823789959e-05f, 5.1044513101590697e-05f, 5.129436337783785e-05f, 5.1545436609438038e-05f, 5.1797738782455472e-05f, 5.2051275912254659e-05f, 5.2306054043643838e-05f, 5.256207925101908e-05f, 5.2819357638509123e-05f, 5.3077895340120925e-05f, 5.3337698519885876e-05f, 5.3598773372006766e-05f, 5.3861126121005503e-05f, 5.4124763021871481e-05f, 5.4389690360210706e-05f, 5.4655914452395701e-05f, 5.492344164571604e-05f, 5.5192278318529731e-05f, 5.5462430880415263e-05f, 5.573390577232443e-05f, 5.6006709466735888e-05f, 5.6280848467809483e-05f, 5.6556329311541305e-05f, 5.6833158565919546e-05f, 5.7111342831081058e-05f, 5.7390888739468748e-05f, 5.7671802955989686e-05f, 5.7954092178174003e-05f, 5.8237763136334607e-05f, 5.8522822593727611e-05f, 5.8809277346713594e-05f, 5.9097134224919652e-05f, 5.9386400091402191e-05f, 5.9677081842810623e-05f, 5.9969186409551716e-05f, 6.0262720755954886e-05f, 6.0557691880438219e-05f, 6.085410681567532e-05f, 6.1151972628763009e-05f, 6.1451296421389772e-05f, 6.1752085330005134e-05f, 6.205434652598976e-05f, 6.2358087215826441e-05f, 6.266331464127196e-05f, 6.2970036079529665e-05f, 6.3278258843423041e-05f, 6.3587990281570016e-05f, 6.3899237778558215e-05f, 6.4212008755120978e-05f, 6.4526310668314301e-05f, 6.4842151011694631e-05f, 6.5159537315497506e-05f, 6.5478477146817133e-05f, 6.579897810978675e-05f, 6.6121047845759973e-05f, 6.6444694033492924e-05f, 6.6769924389327356e-05f, 6.7096746667374613e-05f, 6.742516865970049e-05f, 6.775519819651102e-05f, 6.8086843146339163e-05f, 6.8420111416232386e-05f, 6.8755010951941233e-05f, 6.9091549738108693e-05f, 6.9429735798460642e-05f, 6.9769577195997096e-05f, 7.0111082033184465e-05f, 7.0454258452148721e-05f, 7.0799114634869547e-05f, 7.1145658803375376e-05f, 7.1493899219939464e-05f, 7.1843844187276842e-05f, 7.2195502048742242e-05f, 7.2548881188529125e-05f, 7.290399003186945e-05f, 7.3260837045234625e-05f, 7.3619430736537354e-05f, 7.3979779655334438e-05f, 7.4341892393030686e-05f, 7.470577758308368e-05f, 7.5071443901209654e-05f, 7.5438900065590329e-05f, 7.5808154837080782e-05f, 7.6179217019418295e-05f, 7.6552095459432251e-05f, 7.6926799047255122e-05f, 7.7303336716534349e-05f, 7.7681717444645377e-05f, 7.8061950252905697e-05f, 7.8444044206789877e-05f, 7.8828008416145803e-05f, 7.9213852035411777e-05f, 7.9601584263834808e-05f, 7.9991214345689988e-05f, 8.0382751570500798e-05f, 8.077620527326067e-05f, 8.1171584834655529e-05f, 8.1568899681287412e-05f, 8.1968159285899275e-05f, 8.236937316760078e-05f, 8.2772550892095301e-05f, 8.3177702071907941e-05f, 8.3584836366614777e-05f, 8.3993963483073076e-05f, 8.440509317565281e-05f, 8.4818235246469155e-05f, 8.5233399545616253e-05f, 8.5650595971401971e-05f, 8.6069834470584001e-05f, 8.6491125038606919e-05f, 8.6914477719840535e-05f, 8.733990260781939e-05f, 8.7767409845483345e-05f, 8.8197009625419503e-05f, 8.8628712190105087e-05f, 8.9062527832151775e-05f, 8.9498466894551005e-05f, 8.9936539770920629e-05f, 9.0376756905752637e-05f, 9.0819128794662299e-05f, 9.1263665984638257e-05f, 9.1710379074294091e-05f, 9.2159278714120993e-05f, 9.2610375606741642e-05f, 9.3063680507165429e-05f, 9.3519204223044844e-05f, 9.3976957614933174e-05f, 9.4436951596543441e-05f, 9.4899197135008581e-05f, 9.5363705251142928e-05f, 9.5830487019704996e-05f, 9.6299553569661499e-05f, 9.6770916084452677e-05f, 9.7244585802258989e-05f, 9.7720574016268945e-05f, 9.8198892074948495e-05f, 9.8679551382311454e-05f, 9.9162563398191514e-05f, 9.964793963851541e-05f, 0.00010013569167557749f, 0.00010062583113831562f, 0.00010111836971258843f, 0.00010161331914145398f, 0.00010211069122544964f, 0.00010261049782287355f, 0.00010311275085006726f, 0.00010361746228169987f, 0.00010412464415105352f, 0.0001046343085503103f, 0.00010514646763084056f, 0.00010566113360349256f, 0.00010617831873888367f, 0.00010669803536769293f, 0.00010722029588095494f, 0.00010774511273035542f, 0.00010827249842852797f, 0.00010880246554935244f, 0.00010933502672825474f, 0.00010987019466250805f, 0.00011040798211153557f, 0.00011094840189721471f, 0.00011149146690418283f, 0.00011203719008014436f, 0.00011258558443617959f, 0.00011313666304705482f, 0.00011369043905153408f, 0.0001142469256526924f, 0.00011480613611823064f, 0.00011536808378079174f, 0.00011593278203827863f, 0.00011650024435417371f, 0.00011707048425785974f, 0.00011764351534494249f, 0.00011821935127757486f, 0.00011879800578478263f, 0.00011937949266279173f, 0.00011996382577535725f, 0.00012055101905409388f, 0.00012114108649880818f, 0.00012173404217783227f, 0.00012232990022835927f, 0.00012292867485678039f, 0.00012353038033902363f, 0.00012413503102089404f, 0.00012474264131841597f, 0.00012535322571817655f, 0.00012596679877767121f, 0.00012658337512565072f, 0.00012720296946246994f, 0.00012782559656043842f, 0.00012845127126417239f, 0.00012908000849094889f, 0.00012971182323106136f, 0.00013034673054817695f, 0.00013098474557969578f, 0.00013162588353711184f, 0.00013227015970637552f, 0.00013291758944825827f, 0.00013356818819871863f, 0.00013422197146927041f, 0.00013487895484735245f, 0.00013553915399670016f, 0.00013620258465771914f, 0.0001368692626478604f, 0.0001375392038619974f, 0.00013821242427280515f, 0.00013888893993114086f, 0.00013956876696642683f, 0.0001402519215870348f, 0.00014093842008067257f, 0.00014162827881477217f, 0.00014232151423688018f, 0.00014301814287504989f, 0.00014371818133823532f, 0.0001444216463166872f, 0.00014512855458235089f, 0.00014583892298926631f, 0.00014655276847396972f, 0.00014727010805589761f, 0.00014799095883779226f, 0.00014871533800610978f, 0.00014944326283142971f, 0.00015017475066886674f, 0.00015090981895848462f, 0.00015164848522571187f, 0.00015239076708175971f, 0.0001531366822240418f, 0.00015388624843659632f, 0.00015463948359050993f, 0.0001553964056443438f, 0.00015615703264456186f, 0.00015692138272596097f, 0.00015768947411210342f, 0.00015846132511575126f, 0.00015923695413930299f, 0.00016001637967523233f, 0.00016079962030652911f, 0.00016158669470714223f, 0.00016237762164242504f, 0.00016317241996958258f, 0.00016397110863812129f, 0.00016477370669030079f, 0.00016558023326158775f, 0.00016639070758111234f, 0.00016720514897212651f, 0.00016802357685246475f, 0.00016884601073500707f, 0.00016967247022814418f, 0.00017050297503624505f, 0.00017133754496012662f, 0.00017217619989752601f, 0.00017301895984357478f, 0.00017386584489127572f, 0.00017471687523198194f, 0.00017557207115587821f, 0.00017643145305246474f, 0.00017729504141104333f, 0.00017816285682120578f, 0.00017903491997332493f, 0.00017991125165904784f, 0.00018079187277179155f, 0.00018167680430724125f, 0.00018256606736385074f, 0.00018345968314334562f, 0.00018435767295122863f, 0.00018526005819728775f, 0.00018616686039610653f, 0.00018707810116757708f, 0.00018799380223741559f, 0.00018891398543768021f, 0.00018983867270729165f, 0.00019076788609255621f, 0.00019170164774769138f, 0.00019263997993535412f, 0.00019358290502717156f, 0.00019453044550427444f, 0.00019548262395783304f, 0.00019643946308959591f, 0.00019740098571243092f, 0.00019836721475086942f, 0.0001993381732416526f, 0.00020031388433428086f, 0.00020129437129156561f, 0.00020227965749018402f, 0.00020326976642123635f, 0.00020426472169080589f, 0.00020526454702052201f, 0.00020626926624812546f, 0.00020727890332803691f, 0.00020829348233192797f, 0.0002093130274492952f, 0.00021033756298803667f, 0.00021136711337503168f, 0.00021240170315672301f, 0.00021344135699970224f, 0.00021448609969129784f, 0.00021553595614016611f, 0.00021659095137688503f, 0.00021765111055455113f, 0.00021871645894937908f, 0.00021978702196130443f, 0.00022086282511458907f, 0.00022194389405842991f, 0.00022303025456757032f, 0.00022412193254291461f, 0.00022521895401214571f, 0.00022632134513034556f, 0.00022742913218061879f, 0.00022854234157471931f, 0.00022966099985368007f, 0.00023078513368844576f, 0.00023191476988050885f, 0.00023304993536254836f, 0.00023419065719907224f, 0.00023533696258706247f, 0.00023648887885662349f, 0.00023764643347163393f, 0.00023880965403040127f, 0.00023997856826631986f, 0.00024115320404853222f, 0.00024233358938259342f, 0.00024351975241113875f, 0.00024471172141455483f, 0.00024590952481165371f, 0.00024711319116035049f, 0.00024832274915834434f, 0.00024953822764380235f, 0.00025075965559604753f, 0.00025198706213624945f, 0.00025322047652811852f, 0.00025445992817860381f, 0.00025570544663859428f, 0.00025695706160362296f, 0.00025821480291457537f, 0.00025947870055840068f, 0.00026074878466882681f, 0.00026202508552707884f, 0.00026330763356260088f, 0.00026459645935378176f, 0.00026589159362868389f, 0.000267193067265776f, 0.0002685009112946692f, 0.00026981515689685707f, 0.00027113583540645868f, 0.00027246297831096599f, 0.0002737966172519944f, 0.00027513678402603728f, 0.00027648351058522384f, 0.00027783682903808119f, 0.00027919677165029965f, 0.00028056337084550221f, 0.00028193665920601746f, 0.00028331666947365634f, 0.00028470343455049295f, 0.00028609698749964895f, 0.00028749736154608176f, 0.0002889045900773767f, 0.00029031870664454309f, 0.00029173974496281426f, 0.00029316773891245118f, 0.00029460272253955031f, 0.00029604473005685538f, 0.00029749379584457299f, 0.00029894995445119247f, 0.00030041324059430931f, 0.00030188368916145319f, 0.0003033613352109195f, 0.00030484621397260548f, 0.0003063383608488499f, 0.00030783781141527719f, 0.00030934460142164575f, 0.0003108587667927002f, 0.00031238034362902786f, 0.00031390936820791963f, 0.00031544587698423455f, 0.00031698990659126945f, 0.00031854149384163191f, 0.00032010067572811824f, 0.00032166748942459518f, 0.00032324197228688663f, 0.0003248241618536637f, 0.00032641409584734029f, 0.00032801181217497198f, 0.00032961734892916018f, 0.00033123074438896015f, 0.00033285203702079351f, 0.00033448126547936573f, 0.00033611846860858731f, 0.00033776368544250027f, 0.00033941695520620839f, 0.00034107831731681294f, 0.00034274781138435187f, 0.00034442547721274467f, 0.00034611135480074111f, 0.00034780548434287496f, 0.00034950790623042223f, 0.00035121866105236436f, 0.0003529377895963558f, 0.00035466533284969642f, 0.00035640133200030881f, 0.00035814582843772031f, 0.00035989886375404977f, 0.00036166047974499913f, 0.00036343071841085f, 0.00036520962195746493f, 0.00036699723279729379f, 0.00036879359355038497f, 0.00037059874704540132f, 0.00037241273632064147f, 0.00037423560462506599f, 0.00037606739541932825f, 0.00037790815237681086f, 0.00037975791938466691f, 0.00038161674054486614f, 0.00038348466017524657f, 0.00038536172281057113f, 0.0003872479732035894f, 0.0003891434563261045f, 0.00039104821737004553f, 0.00039296230174854494f, 0.00039488575509702114f, 0.00039681862327426668f, 0.0003987609523635415f, 0.00040071278867367184f, 0.00040267417874015413f, 0.00040464516932626452f, 0.00040662580742417383f, 0.00040861614025606809f, 0.00041061621527527405f, 0.00041262608016739098f, 0.00041464578285142713f, 0.00041667537148094272f, 0.00041871489444519748f, 0.00042076440037030485f, 0.0004228239381203909f, 0.00042489355679875963f, 0.00042697330574906347f, 0.00042906323455648001f, 0.00043116339304889381f, 0.00043327383129808476f, 0.00043539459962092173f, 0.00043752574858056214f, 0.00043966732898765762f, 0.00044181939190156543f, 0.00044398198863156569f, 0.0004461551707380848f, 0.00044833899003392469f, 0.00045053349858549817f, 0.00045273874871407029f, 0.00045495479299700566f, 0.00045718168426902228f, 0.00045941947562345081f, 0.0004616682204135008f, 0.00046392797225353256f, 0.00046619878502033544f, 0.00046848071285441223f, 0.00047077381016127028f, 0.00047307813161271838f, 0.00047539373214817028f, 0.00047772066697595461f, 0.00048005899157463116f, 0.00048240876169431345f, 0.00048477003335799826f, 0.00048714286286290074f, 0.00048952730678179736f, 0.00049192342196437405f, 0.0004943312655385821f, 0.00049675089491199988f, 0.00049918236777320179f, 0.00050162574209313348f, 0.00050408107612649408f, 0.00050654842841312486f, 0.00050902785777940545f, 0.00051151942333965607f, 0.00051402318449754653f, 0.00051653920094751351f, 0.00051906753267618269f, 0.0005216082399637996f, 0.00052416138338566695f, 0.0005267270238135882f, 0.00052930522241731958f, 0.00053189604066602785f, 0.00053449954032975622f, 0.00053711578348089736f, 0.00053974483249567232f, 0.00054238675005561891f, 0.00054504159914908539f, 0.00054770944307273221f, 0.00055039034543304154f, 0.00055308437014783363f, 0.00055579158144779034f, 0.00055851204387798734f, 0.00056124582229943193f, 0.00056399298189061052f, 0.00056675358814904176f, 0.00056952770689283855f, 0.00057231540426227719f, 0.00057511674672137438f, 0.00057793180105947175f, 0.00058076063439282814f, 0.00058360331416621987f, 0.00058645990815454885f, 0.00058933048446445835f, 0.00059221511153595701f, 0.00059511385814405005f, 0.00059802679340037956f, 0.00060095398675487214f, 0.00060389550799739438f, 0.00060685142725941713f, 0.0006098218150156874f, 0.00061280674208590881f, 0.00061580627963642978f, 0.00061882049918194054f, 0.000621849472587178f, 0.00062489327206863895f, 0.0006279519701963026f, 0.00063102563989535991f, 0.00063411435444795262f, 0.00063721818749492057f, 0.00064033721303755726f, 0.00064347150543937433f, 0.0006466211394278742f, 0.00064978619009633219f, 0.00065296673290558664f, 0.00065616284368583773f, 0.00065937459863845598f, 0.00066260207433779892f, 0.00066584534773303625f, 0.00066910449614998526f, 0.00067237959729295367f, 0.00067567072924659276f, 0.0006789779704777588f, 0.00068230139983738408f, 0.00068564109656235638f, 0.00068899714027740883f, 0.00069236961099701771f, 0.00069575858912731062f, 0.00069916415546798305f, 0.00070258639121422502f, 0.0007060253779586572f, 0.00070948119769327579f, 0.00071295393281140744f, 0.00071644366610967402f, 0.00071995048078996612f, 0.00072347446046142744f, 0.00072701568914244734f, 0.00073057425126266454f, 0.00073415023166498031f, 0.00073774371560758037f, 0.00074135478876596872f, 0.00074498353723500947f, 0.00074863004753097982f, 0.00075229440659363314f, 0.00075597670178827073f, 0.0007596770209078262f, 0.00076339545217495725f, 0.00076713208424414997f, 0.00077088700620383231f, 0.00077466030757849787f, 0.00077845207833084074f, 0.00078226240886389992f, 0.00078609139002321516f, 0.00078993911309899244f, 0.00079380566982828102f, 0.00079769115239716022f, 0.00080159565344293724f, 0.00080551926605635629f, 0.00080946208378381761f, 0.00081342420062960807f, 0.00081740571105814216f, 0.00082140670999621428f, 0.00082542729283526244f, 0.00082946755543364154f, 0.00083352759411890992f, 0.00083760750569012528f, 0.00084170738742015284f, 0.00084582733705798455f, 0.00084996745283106938f, 0.0008541278334476555f, 0.00085830857809914343f, 0.00086250978646245106f, 0.00086673155870239048f, 0.00087097399547405533f, 0.00087523719792522141f, 0.00087952126769875766f, 0.00088382630693504996f, 0.00088815241827443583f, 0.00089249970485965214f, 0.00089686827033829395f, 0.00090125821886528554f, 0.00090566965510536384f, 0.00091010268423557389f, 0.00091455741194777622f, 0.0009190339444511671f, 0.0009235323884748105f, 0.00092805285127018256f, 0.00093259544061372924f, 0.00093716026480943526f, 0.00094174743269140684f, 0.000946357053626466f, 0.00095098923751675861f, 0.00095564409480237403f, 0.00096032173646397876f, 0.00096502227402546243f, 0.00096974581955659625f, 0.00097449248567570525f, 0.00097926238555235356f, 0.00098405563291004226f, 0.00098887234202892061f, 0.00099371262774851149f, 0.00099857660547044824f, 0.0010034643911612272f, 0.0010083761013549718f, 0.0010133118531562113f, 0.0010182717642426725f, 0.0010232559528680859f, 0.0010282645378650044f, 0.001033297638647637f, 0.0010383553752146963f, 0.0010434378681522579f, 0.0010485452386366373f, 0.0010536776084372776f, 0.0010588350999196539f, 0.0010640178360481892f, 0.0010692259403891876f, 0.0010744595371137791f, 0.0010797187510008816f, 0.0010850037074401741f, 0.0010903145324350873f, 0.0010956513526058083f, 0.0011010142951922975f, 0.0011064034880573243f, 0.0011118190596895146f, 0.001117261139206414f, 0.0011227298563575672f, 0.0011282253415276103f, 0.0011337477257393803f, 0.0011392971406570386f, 0.0011448737185892096f, 0.0011504775924921367f, 0.0011561088959728505f, 0.0011617677632923549f, 0.0011674543293688287f, 0.0011731687297808417f, 0.0011789111007705873f, 0.0011846815792471309f, 0.0011904803027896732f, 0.0011963074096508321f, 0.0012021630387599373f, 0.0012080473297263435f, 0.0012139604228427582f, 0.0012199024590885878f, 0.0012258735801332975f, 0.0012318739283397897f, 0.0012379036467677978f, 0.0012439628791772975f, 0.0012500517700319339f, 0.0012561704645024665f, 0.0012623191084702287f, 0.0012684978485306077f, 0.0012747068319965392f, 0.0012809462069020183f, 0.001287216122005631f, 0.0012935167267940988f, 0.0012998481714858448f, 0.0013062106070345731f, 0.0013126041851328697f, 0.0013190290582158182f, 0.0013254853794646339f, 0.0013319733028103163f, 0.0013384929829373194f, 0.0013450445752872392f, 0.0013516282360625201f, 0.0013582441222301784f, 0.0013648923915255459f, 0.001371573202456029f, 0.0013782867143048892f, 0.0013850330871350402f, 0.0013918124817928639f, 0.0013986250599120457f, 0.0014054709839174276f, 0.0014123504170288816f, 0.0014192635232652001f, 0.0014262104674480072f, 0.0014331914152056883f, 0.0014402065329773381f, 0.0014472559880167307f, 0.0014543399483963049f, 0.0014614585830111733f, 0.0014686120615831481f, 0.0014758005546647878f, 0.0014830242336434636f, 0.0014902832707454454f, 0.0014975778390400082f, 0.0015049081124435585f, 0.0015122742657237801f, 0.0015196764745038023f, 0.0015271149152663852f, 0.0015345897653581294f, 0.0015421012029937023f, 0.0015496494072600887f, 0.0015572345581208596f, 0.0015648568364204638f, 0.0015725164238885381f, 0.0015802135031442416f, 0.0015879482577006087f, 0.0015957208719689249f, 0.0016035315312631236f, 0.0016113804218042037f, 0.00161926773072467f, 0.0016271936460729947f, 0.0016351583568181007f, 0.0016431620528538676f, 0.0016512049250036575f, 0.001659287165024867f, 0.0016674089656134967f, 0.0016755705204087473f, 0.0016837720239976347f, 0.0016920136719196311f, 0.0017002956606713253f, 0.0017086181877111087f, 0.0017169814514638826f, 0.0017253856513257894f, 0.0017338309876689662f, 0.0017423176618463218f, 0.0017508458761963386f, 0.0017594158340478948f, 0.001768027739725114f, 0.0017766817985522358f, 0.0017853782168585108f, 0.0017941172019831206f, 0.0018028989622801206f, 0.0018117237071234083f, 0.0018205916469117142f, 0.001829502993073619f, 0.0018384579580725934f, 0.0018474567554120649f, 0.0018564995996405073f, 0.0018655867063565562f, 0.0018747182922141492f, 0.0018838945749276913f, 0.0018931157732772455f, 0.0019023821071137499f, 0.0019116937973642581f, 0.0019210510660372067f, 0.0019304541362277093f, 0.0019399032321228745f, 0.0019493985790071519f, 0.0019589404032677024f, 0.001968528932399796f, 0.0019781643950122366f, 0.0019878470208328108f, 0.0019975770407137661f, 0.002007354686637315f, 0.0020171801917211653f, 0.0020270537902240789f, 0.0020369757175514557f, 0.0020469462102609476f, 0.0020569655060680972f, 0.0020670338438520063f, 0.0020771514636610303f, 0.0020873186067185026f, 0.0020975355154284848f, 0.0021078024333815466f, 0.0021181196053605732f, 0.0021284872773466024f, 0.0021389056965246869f, 0.0021493751112897901f, 0.0021598957712527073f, 0.0021704679272460171f, 0.0021810918313300604f, 0.0021917677367989529f, 0.0022024958981866215f, 0.0022132765712728733f, 0.0022241100130894953f, 0.0022349964819263807f, 0.002245936237337689f, 0.0022569295401480322f, 0.0022679766524586944f, 0.0022790778376538812f, 0.0022902333604069985f, 0.0023014434866869631f, 0.0023127084837645437f, 0.0023240286202187341f, 0.0023354041659431547f, 0.00234683539215249f, 0.0023583225713889517f, 0.0023698659775287798f, 0.0023814658857887693f, 0.0023931225727328348f, 0.0024048363162786023f, 0.0024166073957040354f, 0.0024284360916540957f, 0.0024403226861474305f, 0.0024522674625831005f, 0.002464270705747334f, 0.0024763327018203175f, 0.0024884537383830186f, 0.0025006341044240435f, 0.002512874090346525f, 0.0025251739879750485f, 0.0025375340905626083f, 0.0025499546927975989f, 0.0025624360908108432f, 0.0025749785821826496f, 0.0025875824659499099f, 0.0026002480426132266f, 0.0026129756141440794f, 0.0026257654839920222f, 0.0026386179570919216f, 0.0026515333398712229f, 0.0026645119402572597f, 0.0026775540676845927f, 0.002690660033102389f, 0.0027038301489818342f, 0.0027170647293235837f, 0.0027303640896652486f, 0.0027437285470889184f, 0.0027571584202287212f, 0.0027706540292784204f, 0.0027842156959990484f, 0.0027978437437265785f, 0.0028115384973796342f, 0.0028253002834672347f, 0.0028391294300965804f, 0.0028530262669808752f, 0.002866991125447188f, 0.0028810243384443509f, 0.0028951262405509f, 0.0029092971679830493f, 0.0029235374586027078f, 0.0029378474519255364f, 0.0029522274891290398f, 0.002966677913060703f, 0.0029811990682461651f, 0.0029957913008974322f, 0.0030104549589211327f, 0.0030251903919268131f, 0.0030399979512352707f, 0.0030548779898869325f, 0.0030698308626502697f, 0.0030848569260302594f, 0.0030999565382768806f, 0.0031151300593936591f, 0.003130377851146247f, 0.0031457002770710523f, 0.0031610977024839012f, 0.003176570494488753f, 0.0031921190219864489f, 0.0032077436556835082f, 0.003223444768100968f, 0.0032392227335832635f, 0.0032550779283071528f, 0.0032710107302906868f, 0.0032870215194022215f, 0.003303110677369474f, 0.0033192785877886244f, 0.0033355256361334625f, 0.0033518522097645749f, 0.0033682586979385839f, 0.0033847454918174273f, 0.0034013129844776822f, 0.0034179615709199395f, 0.0034346916480782206f, 0.0034515036148294403f, 0.0034683978720029172f, 0.0034853748223899307f, 0.0035024348707533241f, 0.0035195784238371539f, 0.0035368058903763899f, 0.0035541176811066566f, 0.0035715142087740293f, 0.0035889958881448725f, 0.0036065631360157305f, 0.0036242163712232626f, 0.0036419560146542305f, 0.0036597824892555327f, 0.0036776962200442877f, 0.003695697634117969f, 0.0037137871606645854f, 0.0037319652309729151f, 0.0037502322784427888f, 0.0037685887385954225f, 0.0037870350490837993f, 0.0038055716497031079f, 0.0038241989824012237f, 0.0038429174912892484f, 0.0038617276226520984f, 0.0038806298249591436f, 0.0038996245488749012f, 0.0039187122472697797f, 0.0039378933752308755f, 0.0039571683900728252f, 0.0039765377513487077f, 0.0039960019208609985f, 0.0040155613626725838f, 0.0040352165431178227f, 0.0040549679308136662f, 0.0040748159966708282f, 0.0040947612139050149f, 0.0041148040580482066f, 0.0041349450069599952f, 0.0041551845408389762f, 0.0041755231422341997f, 0.0041959612960566738f, 0.0042164994895909262f, 0.0042371382125066205f, 0.0042578779568702351f, 0.0042787192171567894f, 0.0042996624902616378f, 0.0043207082755123138f, 0.0043418570746804356f, 0.0043631093919936697f, 0.0043844657341477536f, 0.0044059266103185727f, 0.0044274925321743045f, 0.0044491640138876153f, 0.0044709415721479184f, 0.0044928257261736965f, 0.0045148169977248754f, 0.0045369159111152699f, 0.0045591229932250791f, 0.0045814387735134514f, 0.0046038637840311062f, 0.0046263985594330211f, 0.0046490436369911762f, 0.0046717995566073652f, 0.0046946668608260685f, 0.0047176460948473884f, 0.004740737806540044f, 0.0047639425464544392f, 0.0047872608678357848f, 0.0048106933266372906f, 0.00483424048153342f, 0.0048579028939332095f, 0.0048816811279936544f, 0.0049055757506331586f, 0.0049295873315450519f, 0.0049537164432111713f, 0.0049779636609155126f, 0.0050023295627579433f, 0.0050268147296679876f, 0.0050514197454186753f, 0.0050761451966404606f, 0.0051009916728352103f, 0.0051259597663902571f, 0.0051510500725925213f, 0.0051762631896427073f, 0.0052015997186695634f, 0.0052270602637442152f, 0.0052526454318945672f, 0.005278355833119773f, 0.0053041920804047854f, 0.0053301547897349642f, 0.0053562445801107663f, 0.0053824620735625018f, 0.0054088078951651675f, 0.0054352826730533453f, 0.0054618870384361825f, 0.0054886216256124385f, 0.0055154870719856088f, 0.005542484018079121f, 0.0055696131075516058f, 0.0055968749872122459f, 0.005624270307036194f, 0.0056517997201800691f, 0.0056794638829975328f, 0.0057072634550549353f, 0.0057351990991470385f, 0.0057632714813128242f, 0.0057914812708513685f, 0.0058198291403378025f, 0.0058483157656393434f, 0.0058769418259314154f, 0.0059057080037138348f, 0.0059346149848270892f, 0.0059636634584686824f, 0.0059928541172095734f, 0.0060221876570106811f, 0.0060516647772394846f, 0.0060812861806866913f, 0.0061110525735829967f, 0.0061409646656159214f, 0.0061710231699467297f, 0.0062012288032274338f, 0.0062315822856178829f, 0.0062620843408029286f, 0.0062927356960096811f, 0.0063235370820248476f, 0.0063544892332121575f, 0.0063855928875298654f, 0.0064168487865483535f, 0.0064482576754678047f, 0.0064798203031359728f, 0.0065115374220660379f, 0.0065434097884545456f, 0.0065754381621994365f, 0.0066076233069181619f, 0.006639965989965896f, 0.0066724669824538224f, 0.0067051270592675275f, 0.006737946999085467f, 0.0067709275843975385f, 0.0068040696015237339f, 0.0068373738406328844f, 0.0068708410957615063f, 0.0069044721648327239f, 0.0069382678496753029f, 0.0069722289560427584f, 0.0070063562936325732f, 0.0070406506761054961f, 0.0070751129211049464f, 0.0071097438502765046f, 0.0071445442892875046f, 0.0071795150678467161f, 0.0072146570197241296f, 0.0072499709827708331f, 0.0072854577989389883f, 0.0073211183143019054f, 0.0073569533790742133f, 0.0073929638476321318f, 0.007429150578533843f, 0.0074655144345399556f, 0.0075020562826340811f, 0.0075387769940434999f, 0.0075756774442599355f, 0.0076127585130604273f, 0.0076500210845283044f, 0.0076874660470742668f, 0.0077250942934575639f, 0.0077629067208072828f, 0.007800904230643735f, 0.0078390877288999506f, 0.007877458125943277f, 0.0079160163365970867f, 0.007954763280162586f, 0.0079936998804407342f, 0.0080328270657542677f, 0.0080721457689698281f, 0.0081116569275202187f, 0.0081513614834267355f, 0.0081912603833216423f, 0.0082313545784707277f, 0.0082716450247959979f, 0.0083121326828984564f, 0.0083528185180810136f, 0.0083937035003714966f, 0.0084347886045457818f, 0.0084760748101510314f, 0.0085175631015290479f, 0.0085592544678397449f, 0.0086011499030847292f, 0.0086432504061309985f, 0.0086855569807347613f, 0.0087280706355653583f, 0.0087707923842293249f, 0.0088137232452945441f, 0.008856864242314539f, 0.0089002164038528737f, 0.0089437807635076774f, 0.0089875583599362888f, 0.0090315502368800132f, 0.0090757574431890135f, 0.0091201810328473167f, 0.0091648220649979389f, 0.0092096816039681402f, 0.0092547607192947981f, 0.0093000604857499131f, 0.0093455819833662256f, 0.0093913262974629676f, 0.009437294518671745f, 0.009483487742962534f, 0.0095299070716698114f, 0.0095765536115188163f, 0.0096234284746519339f, 0.0096705327786552088f, 0.0097178676465849972f, 0.0097654342069947372f, 0.0098132335939618547f, 0.0098612669471148072f, 0.0099095354116602499f, 0.0099580401384103453f, 0.010006782283810191f, 0.010055763009965402f, 0.010104983484669811f, 0.010154444881433316f, 0.010204148379509852f, 0.010254095163925512f, 0.010304286425506799f, 0.010354723360909018f, 0.010405407172644805f, 0.010456339069112801f, 0.010507520264626454f, 0.01055895197944298f, 0.010610635439792454f, 0.010662571877907041f, 0.010714762532050379f, 0.010767208646547101f, 0.0108199114718125f, 0.010872872264382345f, 0.010926092286942836f, 0.01097957280836071f, 0.011033315103713493f, 0.011087320454319899f, 0.011141590147770383f, 0.011196125477957834f, 0.011250927745108432f, 0.011305998255812638f, 0.011361338323056351f, 0.011416949266252214f, 0.011472832411271065f, 0.011528989090473556f, 0.011585420642741913f, 0.011642128413511858f, 0.011699113754804695f, 0.011756378025259528f, 0.011813922590165674f, 0.011871748821495196f, 0.011929858097935623f, 0.011988251804922823f, 0.012046931334674025f, 0.012105898086221019f, 0.012165153465443512f, 0.01222469888510264f, 0.012284535764874659f, 0.01234466553138479f, 0.01240508961824123f, 0.012465809466069334f, 0.012526826522545963f, 0.012588142242433998f, 0.012649758087617025f, 0.012711675527134187f, 0.012773896037215215f, 0.012836421101315615f, 0.012899252210152042f, 0.012962390861737843f, 0.013025838561418769f, 0.013089596821908864f, 0.013153667163326537f, 0.013218051113230798f, 0.013282750206657683f, 0.013347765986156852f, 0.013413100001828356f, 0.013478753811359611f, 0.013544728980062525f, 0.013611027080910821f, 0.013677649694577541f, 0.013744598409472727f, 0.013811874821781299f, 0.013879480535501108f, 0.013947417162481176f, 0.014015686322460127f, 0.014084289643104811f, 0.014153228760049095f, 0.014222505316932879f, 0.014292120965441271f, 0.014362077365343966f, 0.014432376184534825f, 0.014503019099071637f, 0.01457400779321608f, 0.014645343959473872f, 0.014717029298635137f, 0.014789065519814938f, 0.014861454340494037f, 0.014934197486559843f, 0.015007296692347551f, 0.015080753700681501f, 0.015154570262916731f, 0.015228748138980723f, 0.015303289097415374f, 0.015378194915419153f, 0.015453467378889479f, 0.015529108282465296f, 0.015605119429569859f, 0.015681502632453742f, 0.015758259712238033f, 0.015835392498957757f, 0.015912902831605506f, 0.015990792558175291f, 0.016069063535706595f, 0.016147717630328653f, 0.016226756717304936f, 0.01630618268107787f, 0.016385997415313758f, 0.016466202822947938f, 0.016546800816230139f, 0.016627793316770084f, 0.016709182255583294f, 0.016790969573137145f, 0.016873157219397115f, 0.016955747153873279f, 0.017038741345667029f, 0.017122141773518031f, 0.017205950425851383f, 0.017290169300825033f, 0.017374800406377428f, 0.017459845760275362f, 0.017545307390162111f, 0.017631187333605761f, 0.017717487638147785f, 0.017804210361351876f, 0.01789135757085298f, 0.017978931344406614f, 0.018066933769938391f, 0.018155366945593807f, 0.018244232979788257f, 0.018333533991257315f, 0.018423272109107231f, 0.018513449472865717f, 0.018604068232532935f, 0.018695130548632772f, 0.01878663859226434f, 0.018878594545153747f, 0.018971000599706116f, 0.019063858959057843f, 0.019157171837129137f, 0.019250941458676802f, 0.019345170059347268f, 0.01943985988572991f, 0.019535013195410598f, 0.019630632257025528f, 0.019726719350315312f, 0.019823276766179322f, 0.019920306806730327f, 0.020017811785349362f, 0.02011579402674089f, 0.020214255866988232f, 0.020313199653609251f, 0.020412627745612338f, 0.02051254251355265f, 0.020612946339588614f, 0.020713841617538743f, 0.020815230752938695f, 0.020917116163098635f, 0.02101950027716086f, 0.021122385536157719f, 0.021225774393069812f, 0.021329669312884474f, 0.021434072772654543f, 0.021538987261557414f, 0.021644415280954399f, 0.021750359344450344f, 0.021856821977953578f, 0.021963805719736128f, 0.022071313120494231f, 0.022179346743409149f, 0.022287909164208291f, 0.022397002971226609f, 0.022506630765468313f, 0.022616795160668897f, 0.02272749878335743f, 0.022838744272919202f, 0.022950534281658636f, 0.02306287147486253f, 0.023175758530863608f, 0.023289198141104365f, 0.023403193010201238f, 0.023517745856009107f, 0.023632859409686069f, 0.02374853641575856f, 0.023864779632186812f, 0.023981591830430575f, 0.024098975795515214f, 0.024216934326098109f, 0.024335470234535368f, 0.024454586346948901f, 0.024574285503293769f, 0.024694570557425927f, 0.024815444377170235f, 0.024936909844388858f, 0.025058969855049962f, 0.025181627319296754f, 0.025304885161516882f, 0.025428746320412147f, 0.025553213749068562f, 0.025678290415026776f, 0.02580397930035281f, 0.025930283401709161f, 0.026057205730426254f, 0.026184749312574224f, 0.026312917189035081f, 0.026441712415575188f, 0.026571138062918141f, 0.026701197216817966f, 0.026831892978132686f, 0.026963228462898267f, 0.027095206802402898f, 0.027227831143261643f, 0.027361104647491481f, 0.02749503049258667f, 0.027629611871594528f, 0.02776485199319154f, 0.027900754081759883f, 0.028037321377464272f, 0.028174557136329242f, 0.028312464630316753f, 0.028451047147404217f, 0.028590307991662876f, 0.028730250483336592f, 0.028870877958920991f, 0.02901219377124303f, 0.02915420128954092f, 0.029296903899544459f, 0.029440305003555763f, 0.029584408020530365f, 0.02972921638615875f, 0.029874733552948254f, 0.030020962990305381f, 0.030167908184618532f, 0.030315572639341107f, 0.030463959875075049f, 0.030613073429654778f, 0.030762916858231536f, 0.030913493733358156f, 0.031064807645074233f, 0.031216862200991714f, 0.031369661026380925f, 0.031523207764256975f, 0.031677506075466662f, 0.031832559638775695f, 0.031988372150956443f, 0.032144947326876068f, 0.032302288899585085f, 0.032460400620406359f, 0.03261928625902457f, 0.032778949603576059f, 0.032939394460739166f, 0.033100624655824973f, 0.033262644032868528f, 0.033425456454720469f, 0.033589065803139126f, 0.033753475978883105f, 0.033918690901804223f, 0.034084714510941042f, 0.034251550764612712f, 0.034419203640513402f, 0.034587677135807085f, 0.034756975267222885f, 0.034927102071150823f, 0.035098061603738025f, 0.035269857940985493f, 0.035442495178845214f, 0.035615977433317868f, 0.035790308840550934f, 0.035965493556937303f, 0.036141535759214402f, 0.03631843964456373f, 0.036496209430710969f, 0.036674849356026523f, 0.036854363679626578f, 0.037034756681474622f, 0.037216032662483522f, 0.037398195944618046f, 0.037581250870997916f, 0.037765201806001347f, 0.037950053135369102f, 0.038135809266309072f, 0.038322474627601334f, 0.038510053669703753f, 0.038698550864858079f, 0.038887970707196594f, 0.039078317712849225f, 0.039269596420051255f, 0.039461811389251505f, 0.039654967203221064f, 0.039849068467162553f, 0.040044119808819917f, 0.040240125878588773f, 0.040437091349627273f, 0.040635020917967515f, 0.040833919302627524f, 0.041033791245723747f, 0.041234641512584116f, 0.041436474891861669f, 0.041639296195648726f, 0.041843110259591587f, 0.042047921943005863f, 0.042253736128992317f, 0.042460557724553274f, 0.042668391660709619f, 0.042877242892618378f, 0.043087116399690838f, 0.043298017185711281f, 0.043509950278956259f, 0.043722920732314513f, 0.04393693362340742f, 0.044151994054710056f, 0.044368107153672856f, 0.044585278072843848f, 0.04480351198999153f, 0.045022814108228275f, 0.045243189656134414f, 0.045464643887882884f, 0.045687182083364503f, 0.045910809548313856f, 0.046135531614435767f, 0.046361353639532463f, 0.046588281007631273f, 0.046816319129113014f, 0.047045473440840972f, 0.047275749406290542f, 0.047507152515679489f, 0.047739688286098828f, 0.047973362261644358f, 0.048208180013548881f, 0.048444147140314996f, 0.04868126926784859f, 0.04891955204959296f, 0.049159001166663621f, 0.049399622327983748f, 0.049641421270420268f, 0.04988440375892067f, 0.050128575586650424f, 0.050373942575131128f, 0.050620510574379267f, 0.050868285463045733f, 0.05111727314855595f, 0.051367479567250733f, 0.051618910684527813f, 0.051871572494984079f, 0.052125471022558476f, 0.05238061232067566f, 0.052637002472390282f, 0.052894647590532057f, 0.053153553817851487f, 0.05341372732716633f, 0.053675174321508742f, 0.053937901034273192f, 0.054201913729365093f, 0.054467218701350108f, 0.054733822275604249f, 0.055001730808464683f, 0.055270950687381269f, 0.055541488331068867f, 0.055813350189660348f, 0.056086542744860392f, 0.05636107251010003f, 0.056636946030691915f, 0.056914169883986392f, 0.057192750679528316f, 0.05747269505921463f, 0.057754009697452716f, 0.058036701301319528f, 0.05832077661072152f, 0.058606242398555296f, 0.058893105470869143f, 0.059181372667025257f, 0.059471050859862817f, 0.059762146955861864f, 0.060054667895307945f, 0.060348620652457587f, 0.060644012235704592f, 0.060940849687747094f, 0.061239140085755525f, 0.061538890541541283f, 0.061840108201726356f, 0.06214280024791366f, 0.062446973896858292f, 0.062752636400639578f, 0.063059795046833983f, 0.063368457158688843f, 0.063678630095297006f, 0.063990321251772245f, 0.064303538059425597f, 0.064618287985942491f, 0.064934578535560894f, 0.065252417249250128f, 0.065571811704890681f, 0.065892769517454916f, 0.066215298339188614f, 0.066539405859793371f, 0.066865099806610012f, 0.067192387944802756f, 0.067521278077544405f, 0.067851778046202349f, 0.068183895730525523f, 0.068517639048832304f, 0.068853015958199273f, 0.069190034454650939f, 0.069528702573350379f, 0.069869028388790805f, 0.070211020014988038f, 0.070554685605674072f, 0.070900033354491368f, 0.071247071495188219f, 0.071595808301815111f, 0.071946252088921955f, 0.072298411211756342f, 0.072652294066462716f, 0.073007909090282569f, 0.07336526476175563f, 0.073724369600921949f, 0.074085232169525117f, 0.074447861071216287f, 0.074812264951759383f, 0.075178452499237228f, 0.07554643244425864f, 0.075916213560166604f, 0.076287804663247472f, 0.076661214612941106f, 0.077036452312052181f, 0.077413526706962346f, 0.077792446787843639f, 0.078173221588872729f, 0.078555860188446347f, 0.078940371709397744f, 0.079326765319214176f, 0.079715050230255505f, 0.080105235699973784f, 0.080497331031134031f, 0.080891345572035991f, 0.08128728871673703f, 0.081685169905276092f, 0.0820849986238988f, 0.082486784405283578f, 0.082890536828768971f, 0.08329626552058203f, 0.083703980154067784f, 0.084113690449919898f, 0.084525406176412451f, 0.08493913714963279f, 0.08535489323371559f, 0.085772684341078029f, 0.086192520432656114f, 0.086614411518142184f, 0.087038367656223511f, 0.087464398954822206f, 0.087892515571336136f, 0.088322727712881105f, 0.088755045636534247f, 0.089189479649578546f, 0.089626040109748617f, 0.090064737425477562f, 0.090505582056145256f, 0.09094858451232761f, 0.09139375535604724f, 0.091841105201025217f, 0.092290644712934189f, 0.092742384609652603f, 0.093196335661520302f, 0.093652508691595263f, 0.094110914575911642f, 0.094571564243739137f, 0.095034468677843473f, 0.095499638914748344f, 0.09596708604499847f, 0.096436821213424048f, 0.096908855619406459f, 0.09738320051714533f, 0.097859867215926766f, 0.098338867080393036f, 0.098820211530813565f, 0.099303912043357118f, 0.099789980150365526f, 0.10027842744062854f, 0.10076926555966018f, 0.10126250620997641f, 0.10175816115137408f, 0.10225624220121136f, 0.10275676123468946f, 0.10325973018513578f, 0.10376516104428837f, 0.10427306586258191f, 0.10478345674943497f, 0.10529634587353874f, 0.10581174546314712f, 0.10632966780636831f, 0.10685012525145778f, 0.1073731302071126f, 0.10789869514276741f, 0.10842683258889162f, 0.10895755513728819f, 0.10949087544139385f, 0.11002680621658079f, 0.11056536024045975f, 0.1111065503531848f, 0.11165038945775932f, 0.11219689052034373f, 0.11274606657056462f, 0.11329793070182533f, 0.11385249607161822f, 0.11440977590183832f, 0.11496978347909853f, 0.11553253215504648f, 0.11609803534668281f, 0.11666630653668103f, 0.11723735927370903f, 0.11781120717275206f, 0.11838786391543742f, 0.1189673432503605f, 0.11954965899341273f, 0.12013482502811092f, 0.1207228553059282f, 0.1213137638466268f, 0.12190756473859216f, 0.12250427213916888f, 0.12310390027499832f, 0.12370646344235767f, 0.12431197600750089f, 0.12492045240700124f, 0.12553190714809537f, 0.12614635480902928f, 0.12676381003940596f, 0.12738428756053446f, 0.12800780216578111f, 0.1286343687209221f, 0.12926400216449782f, 0.12989671750816922f, 0.13053252983707558f, 0.13117145431019428f, 0.131813506160702f, 0.13245870069633822f, 0.13310705329976991f, 0.13375857942895841f, 0.13441329461752805f, 0.13507121447513626f, 0.135732354687846f, 0.13639673101849961f, 0.13706435930709462f, 0.13773525547116147f, 0.13840943550614293f, 0.13908691548577554f, 0.13976771156247281f, 0.14045183996771032f, 0.1411393170124127f, 0.14183015908734253f, 0.14252438266349113f, 0.14322200429247123f, 0.14392304060691166f, 0.1446275083208538f, 0.14533542423015017f, 0.14604680521286481f, 0.14676166822967573f, 0.14748003032427931f, 0.14820190862379651f, 0.14892732033918138f, 0.14965628276563137f, 0.15038881328299952f, 0.15112492935620914f, 0.15186464853566986f, 0.1526079884576963f, 0.15335496684492847f, 0.15410560150675431f, 0.1548599103397344f, 0.15561791132802838f, 0.15637962254382412f, 0.15714506214776819f, 0.15791424838939916f, 0.15868719960758257f, 0.15946393423094812f, 0.16024447077832912f, 0.16102882785920403f, 0.16181702417414004f, 0.16260907851523909f, 0.1634050097665857f, 0.16420483690469739f, 0.16500857899897703f, 0.1658162552121675f, 0.16662788480080859f, 0.16744348711569607f, 0.16826308160234305f, 0.16908668780144365f, 0.1699143253493389f, 0.17074601397848477f, 0.17158177351792284f, 0.17242162389375282f, 0.17326558512960785f, 0.17411367734713176f, 0.17496592076645892f, 0.17582233570669614f, 0.17668294258640735f, 0.17754776192410024f, 0.17841681433871553f, 0.17929012055011864f, 0.18016770137959345f, 0.18104957775033903f, 0.18193577068796826f, 0.18282630132100924f, 0.18372119088140895f, 0.18462046070503951f, 0.18552413223220693f, 0.18643222700816212f, 0.18734476668361469f, 0.18826177301524921f, 0.18918326786624376f, 0.19010927320679125f, 0.19103981111462334f, 0.19197490377553669f, 0.19291457348392194f, 0.19385884264329528f, 0.19480773376683252f, 0.19576126947790601f, 0.19671947251062383f, 0.1976823657103719f, 0.19864997203435872f, 0.19962231455216262f, 0.20059941644628176f, 0.20158130101268698f, 0.20256799166137712f, 0.20355951191693714f, 0.20455588541909905f, 0.20555713592330557f, 0.20656328730127632f, 0.20757436354157716f, 0.20859038875019206f, 0.20961138715109781f, 0.21063738308684157f, 0.21166840101912124f, 0.21270446552936872f, 0.21374560131933593f, 0.21479183321168374f, 0.21584318615057385f, 0.21689968520226344f, 0.21796135555570278f, 0.21902822252313595f, 0.22010031154070409f, 0.22117764816905203f, 0.2222602580939376f, 0.22334816712684408f, 0.22444140120559558f, 0.22553998639497549f, 0.22664394888734782f, 0.22775331500328175f, 0.22886811119217909f, 0.22998836403290507f, 0.23111410023442172f, 0.23224534663642499f, 0.23338213020998438f, 0.23452447805818624f, 0.23567241741677974f, 0.23682597565482633f, 0.23798518027535226f, 0.23915005891600427f, 0.24032063934970863f, 0.2414969494853331f, 0.24267901736835251f, 0.24386687118151743f, 0.2450605392455259f, 0.24626005001969886f, 0.24746543210265859f, 0.24867671423301049f, 0.24989392529002841f, 0.25111709429434304f, 0.25234625040863401f, 0.25358142293832486f, 0.25482264133228211f, 0.25606993518351717f, 0.25732333422989179f, 0.25858286835482741f, 0.25984856758801733f, 0.2611204621061427f, 0.26239858223359225f, 0.2636829584431849f, 0.26497362135689667f, 0.2662706017465904f, 0.26757393053474982f, 0.26888363879521632f, 0.27019975775393024f, 0.27152231878967509f, 0.27285135343482592f, 0.27418689337610075f, 0.27552897045531638f, 0.27687761667014743f, 0.27823286417488924f, 0.27959474528122435f, 0.28096329245899321f, 0.28233853833696793f, 0.28372051570363049f, 0.28510925750795435f, 0.28650479686019009f, 0.28790716703265479f, 0.28931640146052517f, 0.29073253374263508f, 0.29215559764227622f, 0.29358562708800329f, 0.29502265617444284f, 0.2964667191631063f, 0.29791785048320663f, 0.29937608473247929f, 0.30084145667800716f, 0.30231400125704938f, 0.30379375357787425f, 0.30528074892059653f, 0.30677502273801827f, 0.30827661065647433f, 0.30978554847668166f, 0.31130187217459271f, 0.31282561790225361f, 0.31435682198866555f, 0.31589552094065138f, 0.31744175144372577f, 0.31899555036296995f, 0.32055695474391049f, 0.32212600181340278f, 0.32370272898051844f, 0.32528717383743727f, 0.32687937416034341f, 0.32847936791032617f, 0.33008719323428498f, 0.33170288846583895f, 0.33332649212624071f, 0.33495804292529496f, 0.33659757976228133f, 0.33824514172688175f, 0.33990076810011255f, 0.34156449835526093f, 0.34323637215882596f, 0.34491642937146455f, 0.34660471004894167f, 0.34830125444308524f, 0.35000610300274604f, 0.35171929637476201f, 0.35344087540492714f, 0.35517088113896567f, 0.35690935482351044f, 0.35865633790708634f, 0.36041187204109859f, 0.36217599908082571f, 0.36394876108641749f, 0.3657302003238978f, 0.36752035926617216f, 0.36931928059404051f, 0.3711270071972147f, 0.37294358217534129f, 0.37476904883902873f, 0.37660345071088042f, 0.37844683152653191f, 0.38029923523569409f, 0.38216070600320073f, 0.38403128821006149f, 0.38591102645452019f, 0.38779996555311802f, 0.38969815054176205f, 0.39160562667679899f, 0.39352243943609416f, 0.3954486345201158f, 0.39738425785302461f, 0.39932935558376886f, 0.4012839740871843f, 0.40324815996510027f, 0.40522196004745026f, 0.407205421393389f, 0.40919859129241398f, 0.41120151726549314f, 0.4132142470661978f, 0.41523682868184131f, 0.41726931033462283f, 0.41931174048277747f, 0.42136416782173142f, 0.42342664128526281f, 0.42549921004666863f, 0.42758192351993701f, 0.42967483136092521f, 0.43177798346854385f, 0.43389142998594615f, 0.43601522130172388f, 0.43814940805110841f, 0.44029404111717801f, 0.4424491716320712f, 0.44461485097820552f, 0.44679113078950283f, 0.44897806295262022f, 0.45117569960818715f, 0.45338409315204869f, 0.45560329623651447f, 0.45783336177161427f, 0.46007434292635929f, 0.46232629313001f, 0.46458926607334983f, 0.46686331570996537f, 0.46914849625753263f, 0.47144486219910975f, 0.47375246828443607f, 0.47607136953123724f, 0.47840162122653712f, 0.48074327892797597f, 0.48309639846513491f, 0.48546103594086698f, 0.48783724773263498f, 0.49022509049385532f, 0.49262462115524891f, 0.49503589692619859f, 0.49745897529611283f, 0.49989391403579658f, 0.50234077119882869f, 0.50479960512294586f, 0.50727047443143369f, 0.509753438034524f, 0.51224855513080003f, 0.51475588520860704f, 0.51727548804747148f, 0.51980742371952537f, 0.52235175259093936f, 0.52490853532336124f, 0.52747783287536287f, 0.530059706503893f, 0.53265421776573818f, 0.53526142851899028f, 0.53788140092452086f, 0.5405141974474641f, 0.54315988085870526f, 0.54581851423637751f, 0.54849016096736602f, 0.55117488474881937f, 0.55387274958966726f, 0.556583819812148f, 0.55930816005334094f, 0.56204583526670793f, 0.56479691072364224f, 0.56756145201502439f, 0.57033952505278573f, 0.57313119607148078f, 0.57593653162986536f, 0.57875559861248427f, 0.58158846423126531f, 0.58443519602712235f, 0.58729586187156513f, 0.59017052996831787f, 0.59305926885494509f, 0.5959621474044855f, 0.5988792348270946f, 0.60181060067169445f, 0.60475631482763192f, 0.60771644752634468f, 0.61069106934303641f, 0.61368025119835856f, 0.6166840643601017f, 0.6197025804448949f, 0.62273587141991271f, 0.62578400960459113f, 0.6288470676723521f, 0.63192511865233592f, 0.63501823593114259f, 0.63812649325458115f, 0.64124996472942841f, 0.64438872482519527f, 0.64754284837590281f, 0.65071241058186591f, 0.65389748701148642f, 0.65709815360305479f, 0.6603144866665609f, 0.66354656288551295f, 0.66679445931876602f, 0.67005825340235914f, 0.6733380229513618f, 0.67663384616172895f, 0.67994580161216522f, 0.68327396826599895f, 0.68661842547306418f, 0.68997925297159279f, 0.69335653089011573f, 0.69675033974937317f, 0.70016076046423459f, 0.70358787434562753f, 0.70703176310247662f, 0.71049250884365134f, 0.71397019407992379f, 0.71746490172593602f, 0.72097671510217676f, 0.72450571793696783f, 0.72805199436846058f, 0.73161562894664178f, 0.73519670663534942f, 0.73879531281429867f, 0.7424115332811172f, 0.74604545425339064f, 0.74969716237071882f, 0.75336674469678067f, 0.75705428872141056f, 0.76075988236268366f, 0.76448361396901265f, 0.76822557232125377f, 0.77198584663482361f, 0.77576452656182626f, 0.77956170219319054f, 0.78337746406081821f, 0.78721190313974221f, 0.79106511085029596f, 0.79493717906029271f, 0.798828200087216f, 0.80273826670042048f, 0.806667472123344f, 0.81061591003573008f, 0.81458367457586145f, 0.81857086034280457f, 0.82257756239866464f, 0.82660387627085263f, 0.8306498979543625f, 0.83471572391406001f, 0.83880145108698256f, 0.84290717688465033f, 0.8470329991953891f, 0.85117901638666349f, 0.85534532730742252f, 0.85953203129045674f, 0.86373922815476589f, 0.86796701820793898f, 0.87221550224854616f, 0.87648478156854148f, 0.88077495795567795f, 0.88508613369593481f, 0.88941841157595558f, 0.89377189488549924f, 0.89814668741990245f, 0.90254289348255434f, 0.90696061788738358f, 0.91139996596135686f, 0.91586104354699061f, 0.92034395700487381f, 0.92484881321620482f, 0.9293757195853386f, 0.93392478404234791f, 0.93849611504559671f, 0.94308982158432586f, 0.94770601318125147f, 0.9523447998951764f, 0.95700629232361401f, 0.9616906016054253f, 0.96639783942346846f, 0.97112811800726162f, 0.9758815501356588f, 0.98065824913953858f, 0.98545832890450602f, 0.99028190387360837f, 0.99512908905006314f, 1.0f, 1.0048947528552166f, 1.0098134643159469f, 1.0147562516536435f, 1.0197232327137742f, 1.0247145259186305f, 1.0297302502701529f, 1.0347705253527655f, 1.0398354713362301f, 1.0449252089785086f, 1.050039859628644f, 1.0551795452296524f, 1.0603443883214314f, 1.0655345120436808f, 1.0707500401388383f, 1.0759910969550313f, 1.0812578074490395f, 1.086550297189276f, 1.0918686923587797f, 1.0972131197582244f, 1.1025837068089421f, 1.1079805815559607f, 1.1134038726710562f, 1.1188537094558222f, 1.1243302218447506f, 1.1298335404083317f, 1.1353637963561649f, 1.1409211215400887f, 1.1465056484573242f, 1.1521175102536325f, 1.1577568407264915f, 1.163423774328284f, 1.1691184461695043f, 1.1748409920219791f, 1.1805915483221041f, 1.1863702521740984f, 1.1921772413532716f, 1.1980126543093097f, 1.203876630169576f, 1.2097693087424271f, 1.2156908305205474f, 1.2216413366842986f, 1.2276209691050848f, 1.2336298703487356f, 1.2396681836789056f, 1.2457360530604891f, 1.2518336231630531f, 1.2579610393642868f, 1.2641184477534664f, 1.2703059951349396f, 1.2765238290316252f, 1.2827720976885297f, 1.289050950076283f, 1.2953605358946885f, 1.3017010055762941f, 1.3080725102899768f, 1.3144752019445491f, 1.3209092331923786f, 1.327374757433029f, 1.3338719288169167f, 1.3404009022489867f, 1.3469618333924049f, 1.3535548786722702f, 1.3601801952793438f, 1.3668379411737963f, 1.3735282750889752f, 1.3802513565351877f, 1.387007345803505f, 1.3937964039695832f, 1.400618692897504f, 1.4074743752436336f, 1.4143636144605016f, 1.4212865748006966f, 1.4282434213207835f, 1.4352343198852378f, 1.4422594371704009f, 1.4493189406684539f, 1.4564129986914103f, 1.4635417803751296f, 1.4707054556833496f, 1.4779041954117385f, 1.4851381711919667f, 1.4924075554957996f, 1.4997125216392098f, 1.5070532437865074f, 1.5144298969544947f, 1.5218426570166381f, 1.5292917007072608f, 1.5367772056257567f, 1.5442993502408253f, 1.5518583138947257f, 1.5594542768075537f, 1.5670874200815372f, 1.5747579257053552f, 1.5824659765584765f, 1.5902117564155194f, 1.5979954499506333f, 1.6058172427419024f, 1.6136773212757693f, 1.6215758729514822f, 1.6295130860855618f, 1.637489149916292f, 1.645504254608231f, 1.6535585912567456f, 1.6616523518925677f, 1.6697857294863712f, 1.6779589179533747f, 1.6861721121579631f, 1.694425507918335f, 1.7027193020111702f, 1.7110536921763217f, 1.7194288771215307f, 1.7278450565271632f, 1.7363024310509716f, 1.7448012023328778f, 1.7533415729997821f, 1.7619237466703928f, 1.7705479279600815f, 1.7792143224857622f, 1.7879231368707915f, 1.7966745787498977f, 1.8054688567741288f, 1.8143061806158287f, 1.8231867609736352f, 1.8321108095775041f, 1.8410785391937567f, 1.8500901636301534f, 1.8591458977409905f, 1.8682459574322223f, 1.8773905596666107f, 1.8865799224688955f, 1.8958142649309946f, 1.9050938072172259f, 1.9144187705695579f, 1.9237893773128836f, 1.9332058508603212f, 1.9426684157185412f, 1.9521772974931189f, 1.9617327228939123f, 1.971334919740469f, 1.9809841169674569f, 1.9906805446301223f, 2.0004244339097745f, 2.0102160171192995f, 2.0200555277086965f, 2.0299432002706448f, 2.0398792705460971f, 2.0498639754298997f, 2.0598975529764409f, 2.0699802424053262f, 2.0801122841070816f, 2.0902939196488859f, 2.1005253917803293f, 2.1108069444392012f, 2.121138822757306f, 2.131521273066308f, 2.1419545429036044f, 2.152438881018226f, 2.162974537376769f, 2.1735617631693551f, 2.1842008108156179f, 2.194891933970724f, 2.2056353875314194f, 2.2164314276421053f, 2.2272803117009485f, 2.2381822983660147f, 2.2491376475614371f, 2.2601466204836136f, 2.2712094796074336f, 2.2823264886925374f, 2.2934979127896016f, 2.3047240182466617f, 2.3160050727154613f, 2.3273413451578313f, 2.3387331058521061f, 2.3501806263995655f, 2.3616841797309096f, 2.3732440401127675f, 2.384860483154235f, 2.3965337858134474f, 2.4082642264041811f, 2.4200520846024891f, 2.4318976414533702f, 2.4438011793774685f, 2.455762982177808f, 2.4677833350465583f, 2.4798625245718333f, 2.4920008387445258f, 2.5041985669651732f, 2.5164560000508551f, 2.528773430242131f, 2.5411511512100047f, 2.5535894580629268f, 2.5660886473538316f, 2.5786490170872054f, 2.5912708667261946f, 2.6039544971997426f, 2.616700210909765f, 2.6295083117383613f, 2.6423791050550589f, 2.6553128977240918f, 2.6683099981117202f, 2.6813707160935807f, 2.694495363062074f, 2.7076842519337898f, 2.7209376971569679f, 2.7342560147189934f, 2.7476395221539325f, 2.7610885385501014f, 2.7746033845576754f, 2.788184382396333f, 2.8018318558629378f, 2.8155461303392597f, 2.829327532799732f, 2.8431763918192465f, 2.8570930375809884f, 2.8710778018843075f, 2.8851310181526295f, 2.8992530214414063f, 2.9134441484461018f, 2.9277047375102225f, 2.9420351286333819f, 2.9564356634794078f, 2.9709066853844881f, 2.9854485393653558f, 3.0000615721275166f, 3.0147461320735136f, 3.0295025693112336f, 3.0443312356622561f, 3.0592324846702388f, 3.0742066716093501f, 3.0892541534927358f, 3.1043752890810343f, 3.1195704388909276f, 3.1348399652037382f, 3.1501842320740665f, 3.1656036053384695f, 3.1810984526241839f, 3.1966691433578913f, 3.2123160487745253f, 3.2280395419261225f, 3.2438399976907175f, 3.2597177927812799f, 3.2756733057546965f, 3.2917069170207962f, 3.3078190088514203f, 3.3240099653895356f, 3.3402801726583946f, 3.3566300185707374f, 3.3730598929380426f, 3.3895701874798179f, 3.4061612958329417f, 3.4228336135610484f, 3.4395875381639578f, 3.4564234690871531f, 3.4733418077313054f, 3.4903429574618414f, 3.5074273236185629f, 3.5245953135253099f, 3.541847336499671f, 3.5591838038627439f, 3.576605128948942f, 3.5941117271158474f, 3.6117040157541149f, 3.6293824142974249f, 3.6471473442324802f, 3.6649992291090578f, 3.6829384945501062f, 3.7009655682618923f, 3.7190808800442006f, 3.7372848618005787f, 3.7555779475486348f, 3.7739605734303869f, 3.7924331777226605f, 3.8109962008475367f, 3.829650085382855f, 3.8483952760727633f, 3.8672322198383227f, 3.886161365788162f, 3.905183165229186f, 3.9242980716773355f, 3.9435065408683991f, 3.9628090307688804f, 3.9822060015869143f, 4.0016979157832431f, 4.0212852380822373f, 4.0409684354829807f, 4.0607479772704016f, 4.0806243350264602f, 4.1005979826413981f, 4.1206693963250274f, 4.1408390546180929f, 4.1611074384036772f, 4.1814750309186666f, 4.2019423177652735f, 4.2225097869226103f, 4.24317792875833f, 4.2639472360403117f, 4.2848182039484133f, 4.305791330086274f, 4.3268671144931803f, 4.3480460596559887f, 4.3693286705211039f, 4.3907154545065161f, 4.4122069215139064f, 4.4338035839407928f, 4.4555059566927566f, 4.4773145571957134f, 4.4992299054082494f, 4.5212525238340229f, 4.543382937534215f, 4.5656216741400533f, 4.5879692638653884f, 4.6104262395193398f, 4.6329931365189934f, 4.6556704929021686f, 4.6784588493402488f, 4.7013587491510709f, 4.7243707383118752f, 4.7474953654723295f, 4.7707331819676027f, 4.7940847418315151f, 4.8175506018097458f, 4.8411313213731049f, 4.8648274627308741f, 4.8886395908442122f, 4.9125682734396223f, 4.936614081022487f, 4.9607775868906749f, 4.9850593671482022f, 5.0094600007189749f, 5.0339800693605881f, 5.0586201576781944f, 5.0833808531384461f, 5.1082627460834988f, 5.1332664297450874f, 5.1583925002586701f, 5.1836415566776397f, 5.2090142009876068f, 5.2345110381207549f, 5.2601326759702589f, 5.2858797254047829f, 5.3117528002830401f, 5.3377525174684299f, 5.3638794968437482f, 5.3901343613259618f, 5.4165177368810635f, 5.4430302525389935f, 5.4696725404086397f, 5.4964452356929048f, 5.5233489767038542f, 5.5503844048779332f, 5.5775521647912596f, 5.604852904174991f, 5.6322872739307703f, 5.6598559281462437f, 5.687559524110652f, 5.7153987223305069f, 5.7433741865453358f, 5.7714865837435063f, 5.7997365841781292f, 5.8281248613830394f, 5.8566520921888525f, 5.8853189567391047f, 5.9141261385064636f, 5.9430743243090296f, 5.972164204326706f, 6.0013964721176567f, 6.030771824634841f, 6.0602909622426324f, 6.0899545887335131f, 6.1197634113448567f, 6.1497181407757866f, 6.1798194912041264f, 6.2100681803034208f, 6.2404649292600514f, 6.271010462790426f, 6.3017055091582632f, 6.3325508001919495f, 6.3635470713019933f, 6.3946950614985543f, 6.4259955134090641f, 6.4574491732959318f, 6.4890567910743382f, 6.5208191203301125f, 6.5527369183376996f, 6.5848109460782167f, 6.6170419682575945f, 6.6494307533248111f, 6.681978073490213f, 6.7146847047439246f, 6.7475514268743488f, 6.7805790234867631f, 6.8137682820219974f, 6.847119993775209f, 6.8806349539147504f, 6.9143139615011284f, 6.9481578195060498f, 6.9821673348315727f, 7.0163433183293398f, 7.0506865848199123f, 7.0851979531121971f, 7.1198782460229681f, 7.1547282903964842f, 7.1897489171242013f, 7.2249409611645854f, 7.2603052615630173f, 7.2958426614717977f, 7.3315540081702473f, 7.3674401530849138f, 7.4035019518098641f, 7.4397402641270869f, 7.4761559540269928f, 7.5127498897290117f, 7.549522943702291f, 7.5864759926865011f, 7.6236099177127361f, 7.6609256041245182f, 7.6984239415989082f, 7.7361058241677174f, 7.773972150238821f, 7.8120238226175767f, 7.8502617485283546f, 7.8886868396361614f, 7.9273000120683799f, 7.9661021864366104f, 8.0050942878586184f, 8.0442772459803926f, 8.0836519949983092f, 8.1232194736814058f, 8.1629806253937591f, 8.2029363981169823f, 8.2430877444728257f, 8.2834356217458858f, 8.3239809919064296f, 8.3647248216333328f, 8.4056680823371224f, 8.4468117501831461f, 8.4881568061148318f, 8.5297042358770891f, 8.571455030039802f, 8.6134101840214505f, 8.6555706981128413f, 8.6979375775009586f, 8.7405118322929276f, 8.7832944775400978f, 8.8262865332622447f, 8.8694890244718909f, 8.9129029811987373f, 8.9565294385142273f, 9.0003694365562268f, 9.0444240205538158f, 9.0886942408522113f, 9.133181152937814f, 9.1778858174633662f, 9.2228093002732479f, 9.2679526724288781f, 9.3133170102342611f, 9.3589033952616436f, 9.4047129143772974f, 9.4507466597674377f, 9.4970057289642629f, 9.5434912248721204f, 9.5902042557937985f, 9.6371459354569549f, 9.684317383040673f, 9.7317197232021346f, 9.7793540861034458f, 9.8272216074385756f, 9.8753234284604314f, 9.923660696008076f, 9.9722345625340623f, 10.021046186131915f, 10.070096730563742f, 10.119387365287977f, 10.168919265487263f, 10.218693612096475f, 10.268711591830868f, 10.318974397214378f, 10.36948322660805f, 10.42023928423861f, 10.471243780227178f, 10.522497930618114f, 10.574002957408018f, 10.625760088574861f, 10.677770558107259f, 10.730035606033903f, 10.782556478453113f, 10.835334427562556f, 10.888370711689095f, 10.941666595318791f, 10.995223349127057f, 11.049042250008942f, 11.103124581109581f, 11.157471631854794f, 11.212084697981814f, 11.26696508157019f, 11.322114091072832f, 11.377533041347199f, 11.433223253686654f, 11.489186055851967f, 11.545422782102962f, 11.601934773230344f, 11.65872337658765f, 11.715789946123383f, 11.773135842413289f, 11.830762432692795f, 11.888671090889607f, 11.946863197656471f, 12.005340140404082f, 12.064103313334172f, 12.123154117472742f, 12.182493960703473f, 12.242124257801287f, 12.302046430466076f, 12.362261907356606f, 12.422772124124576f, 12.483578523448841f, 12.544682555069812f, 12.606085675824026f, 12.667789349678872f, 12.729795047767496f, 12.792104248423877f, 12.854718437218079f, 12.917639106991658f, 12.980867757893263f, 13.0444058974144f, 13.108255040425375f, 13.172416709211404f, 13.23689243350892f, 13.301683750542033f, 13.366792205059188f, 13.432219349369987f, 13.497966743382213f, 13.564035954639001f, 13.630428558356233f, 13.697146137460072f, 13.764190282624725f, 13.831562592310346f, 13.899264672801165f, 13.96729813824377f, 14.0356646106856f, 14.104365720113616f, 14.173403104493163f, 14.242778409807016f, 14.312493290094636f, 14.382549407491597f, 14.45294843226921f, 14.523692042874359f, 14.594781925969505f, 14.666219776472907f, 14.738007297599033f, 14.81014620089916f, 14.882638206302186f, 14.95548504215564f, 15.02868844526688f, 15.102250160944511f, 15.176171943039991f, 15.250455553989443f, 15.325102764855687f, 15.400115355370453f, 15.475495113976818f, 15.551243837871848f, 15.627363333049439f, 15.703855414343392f, 15.780721905470658f, 15.85796463907484f, 15.935585456769875f, 16.013586209183948f, 16.09196875600361f, 16.170734966018113f, 16.249886717163982f, 16.329425896569767f, 16.40935440060105f, 16.489674134905655f, 16.570387014459076f, 16.651494963610144f, 16.7329999161269f, 16.814903815242701f, 16.897208613702553f, 16.979916273809664f, 17.063028767472233f, 17.146548076250461f, 17.230476191403799f, 17.314815113938415f, 17.39956685465491f, 17.484733434196265f, 17.570316883096002f, 17.656319241826594f, 17.742742560848143f, 17.829588900657228f, 17.916860331836059f, 18.00455893510183f, 18.092686801356336f, 18.181246031735814f, 18.27023873766105f, 18.359667040887704f, 18.449533073556918f, 18.539838978246124f, 18.630586908020149f, 18.721779026482544f, 18.813417507827154f, 18.905504536889971f, 18.998042309201224f, 19.091033031037714f, 19.184478919475421f, 19.278382202442366f, 19.372745118771729f, 19.467569918255219f, 19.562858861696728f, 19.658614220966218f, 19.754838279053896f, 19.851533330124635f, 19.948701679572693f, 20.046345644076645f, 20.14446755165465f, 20.243069741719928f, 20.342154565136561f, 20.441724384275521f, 20.541781573071006f, 20.642328517077029f, 20.743367613524313f, 20.84490127137742f, 20.946931911392202f, 21.049461966173517f, 21.152493880233219f, 21.256030110048442f, 21.360073124120174f, 21.464625403032095f, 21.569689439509741f, 21.675267738479917f, 21.781362817130429f, 21.887977204970085f, 21.995113443889029f, 22.10277408821932f, 22.210961704795839f, 22.319678873017494f, 22.428928184908717f, 22.538712245181248f, 22.649033671296252f, 22.75989509352673f, 22.8712991550202f, 22.983248511861749f, 23.095745833137336f, 23.208793800997441f, 23.322395110721008f, 23.436552470779699f, 23.551268602902482f, 23.666546242140512f, 23.782388136932347f, 23.898797049169467f, 24.015775754262133f, 24.133327041205547f, 24.251453712646367f, 24.370158584949497f, 24.48944448826526f, 24.609314266596865f, 24.729770777868211f, 24.850816893992036f, 24.97245550093837f, 25.094689498803355f, 25.217521801878398f, 25.340955338719631f, 25.464993052217746f, 25.589637899668158f, 25.714892852841519f, 25.840760898054555f, 25.967245036241277f, 26.09434828302453f, 26.222073668787882f, 26.35042423874788f, 26.479403053026662f, 26.609013186724894f, 26.739257729995114f, 26.870139788115381f, 27.001662481563329f, 27.133828946090556f, 27.266642332797392f, 27.400105808208021f, 27.534222554345988f, 27.668995768810042f, 27.804428664850402f, 27.940524471445343f, 28.077286433378202f, 28.214717811314713f, 28.352821881880779f, 28.491601937740562f, 28.631061287675013f, 28.771203256660744f, 28.912031185949299f, 29.053548433146837f, 29.195758372294158f, 29.338664393947159f, 29.482269905257674f, 29.626578330054702f, 29.771593108926037f, 29.917317699300298f, 30.06375557552937f, 30.21091022897123f, 30.35878516807318f, 30.507383918455513f, 30.656710022995561f, 30.806767041912167f, 30.957558552850561f, 31.109088150967661f, 31.261359449017796f, 31.414376077438831f, 31.568141684438721f, 31.722659936082511f, 31.877934516379717f, 32.033969127372174f, 32.190767489222303f, 32.348333340301785f, 32.506670437280725f, 32.665782555217191f, 32.825673487647229f, 32.986347046675299f, 33.14780706306518f, 33.310057386331287f, 33.473101884830463f, 33.636944445854191f, 33.801588975721302f, 33.967039399871069f, 34.133299662956844f, 34.300373728940066f, 34.468265581184795f, 34.636979222552661f, 34.806518675498332f, 34.97688798216538f, 35.148091204482675f, 35.320132424261232f, 35.493015743291508f, 35.666745283441237f, 35.841325186753643f, 36.016759615546256f, 36.193052752510098f, 36.370208800809451f, 36.548231984182038f, 36.727126547039738f, 36.906896754569757f, 37.087546892836379f, 37.26908126888307f, 37.451504210835232f, 37.634820068003378f, 37.819033210986802f, 38.00414803177781f, 38.190168943866432f, 38.377100382345624f, 38.564946804017048f, 38.753712687497284f, 38.943402533324658f, 39.1340208640665f, 39.325572224426992f, 39.518061181355534f, 39.7114923241556f, 39.905870264594178f, 40.101199637011703f, 40.297485098432574f, 40.494731328676181f, 40.692943030468449f, 40.892124929554001f, 41.092281774808811f, 41.293418338353419f, 41.495539415666727f, 41.698649825700315f, 41.902754410993346f, 42.107858037787992f, 42.313965596145515f, 42.521082000062783f, 42.729212187589489f, 42.938361120945849f, 43.148533786640925f, 43.359735195591497f, 43.571970383241556f, 43.785244409682342f, 43.999562359772987f, 44.214929343261772f, 44.431350494907903f, 44.648830974603982f, 44.867375967499008f, 45.086990684122f, 45.307680360506232f, 45.529450258314064f, 45.752305664962392f, 45.97625189374871f, 46.201294283977795f, 46.427438201088997f, 46.65468903678417f, 46.883052209156212f, 47.112533162818252f, 47.343137369033442f, 47.574870325845431f, 47.807737558209425f, 48.041744618123921f, 48.276897084763071f, 48.513200564609711f, 48.750660691589033f, 48.989283127202881f, 49.229073560664773f, 49.470037709035509f, 49.71218131735948f, 49.955510158801673f, 50.200030034785271f, 50.445746775129997f, 50.692666238191102f, 50.940794310999031f, 51.190136909399797f, 51.440699978196008f, 51.692489491288626f, 51.945511451819364f, 52.199771892313848f, 52.455276874825408f, 52.712032491079633f, 52.970044862619616f, 53.229320140951877f, 53.489864507693042f, 53.751684174717226f, 54.014785384304126f, 54.279174409287862f, 54.544857553206519f, 54.811841150452466f, 55.080131566423319f, 55.34973519767378f, 55.620658472068079f, 55.892907848933262f, 56.166489819213183f, 56.441410905623272f, 56.717677662806025f, 56.995296677487303f, 57.274274568633352f, 57.55461798760863f, 57.836333618334379f, 58.119428177447986f, 58.403908414463103f, 58.689781111930607f, 58.977053085600268f, 59.265731184583274f, 59.555822291515518f, 59.847333322721681f, 60.140271228380179f, 60.434642992688794f, 60.730455634031252f, 61.027716205144536f, 61.326431793287014f, 61.626609520407456f, 61.928256543314788f, 62.231380053848767f, 62.535987279051412f, 62.842085481339339f, 63.149681958676894f, 63.458784044750146f, 63.769399109141766f, 64.081534557506686f, 64.395197831748703f, 64.710396410197887f, 65.027137807788904f, 65.34542957624015f, 65.665279304233806f, 65.986694617596797f, 66.30968317948259f, 66.634252690553879f, 66.960410889166184f, 67.28816555155241f, 67.617524492008158f, 67.948495563078097f, 68.281086655743152f, 68.615305699608641f, 68.951160663093361f, 69.288659553619539f, 69.627810417803758f, 69.968621341648785f, 70.31110045073639f, 70.655255910421047f, 71.001095926024647f, 71.348628743032066f, 71.697862647287806f, 72.048805965193552f, 72.401467063906637f, 72.755854351539554f, 73.111976277360483f, 73.469841331994616f, 73.829458047626716f, 74.190834998204437f, 74.553980799642801f, 74.918904110029615f, 75.285613629831886f, 75.65411810210324f, 76.024426312692398f, 76.396547090452657f, 76.770489307452351f, 77.146261879186369f, 77.523873764788817f, 77.903333967246468f, 78.284651533613541f, 78.667835555227327f, 79.052895167924987f, 79.439839552261333f, 79.828677933727718f, 80.219419582971994f, 80.612073816019574f, 81.006649994495461f, 81.403157525847547f, 81.801605863570842f, 82.202004507432861f, 82.604363003700144f, 83.008690945365856f, 83.414997972378487f, 83.823293771871676f, 84.233588078395201f, 84.645890674147068f, 85.0602113892067f, 85.476560101769351f, 85.894946738381591f, 86.315381274177952f, 86.737873733118846f, 87.162434188229454f, 87.589072761839915f, 88.017799625826711f, 88.448625001855106f, 88.881559161622931f, 89.316612427105383f, 89.75379517080124f, 90.193117815980045f, 90.634590836930698f, 91.078224759211153f, 91.524030159899368f, 91.972017667845464f, 92.422197963925186f, 92.874581781294509f, 93.329179905645546f, 93.786003175463733f, 94.245062482286187f, 94.706368770961433f, 95.169933039910291f, 95.635766341388162f, 96.103879781748503f, 96.574284521707611f, 97.046991776610739f, 97.522012816699501f, 97.999358967380502f, 98.479041609495496f, 98.961072179592563f, 99.445462170198923f, 99.93222313009484f, 100.42136666458902f, 100.91290443579527f, 101.40684816291058f, 101.9032096224945f, 102.40200064874995f, 102.90323313380532f, 103.40691902799803f, 103.91307034015948f, 104.4216991379013f, 104.93281754790311f, 105.44643775620163f, 105.96257200848122f, 106.48123261036584f, 107.00243192771241f, 107.5261823869057f, 108.05249647515456f, 108.5813867407896f, 109.11286579356246f, 109.64694630494637f, 110.18364100843829f, 110.72296269986251f, 111.2649242376757f, 111.80953854327352f, 112.35681860129866f, 112.90677745995042f, 113.45942823129583f, 114.0147840915822f, 114.57285828155139f, 115.13366410675533f, 115.69721493787343f, 116.2635242110312f, 116.83260542812069f, 117.40447215712238f, 117.97913803242865f, 118.55661675516887f, 119.13692209353607f, 119.72006788311512f, 120.30606802721273f, 120.89493649718881f, 121.48668733278966f, 122.08133464248264f, 122.67889260379259f, 123.27937546363982f, 123.8827975386798f, 124.48917321564447f, 125.0985169516853f, 125.71084327471793f, 126.32616678376854f, 126.94450214932196f, 127.56586411367141f, 128.19026749126996f, 128.81772716908387f, 129.44825810694724f, 130.08187533791903f, 130.71859396864124f, 131.35842917969916f, 132.00139622598326f, 132.64751043705297f, 133.29678721750213f, 133.94924204732618f, 134.60489048229144f, 135.26374815430574f, 135.92583077179134f, 136.59115412005926f, 137.25973406168575f, 137.93158653689048f, 138.60672756391648f, 139.28517323941219f, 139.96693973881514f, 140.65204331673763f, 141.34050030735429f, 142.03232712479146f, 142.72754026351859f, 143.42615629874149f, 144.12819188679751f, 144.83366376555261f, 145.54258875480053f, 146.25498375666373f, 146.9708657559963f, 147.69025182078914f, 148.4131591025766f, 149.13960483684565f, 149.86960634344669f, 150.60318102700646f, 151.34034637734311f, 152.08111996988308f, 152.82551946608021f, 153.57356261383677f, 154.32526724792663f, 155.08065129042049f, 155.83973275111313f, 156.60252972795283f, 157.36906040747289f, 158.13934306522512f, 158.91339606621571f, 159.691237865343f, 160.47288700783744f, 161.25836212970393f, 162.04768195816584f, 162.84086531211182f, 163.63793110254423f, 164.43889833303012f, 165.24378610015441f, 166.05261359397494f, 166.86540009848025f, 167.68216499204914f, 168.50292774791288f, 169.32770793461933f, 170.1565252164996f, 170.98939935413679f, 171.82635020483724f, 172.66739772310382f, 173.5125619611118f, 174.36186306918691f, 175.21532129628568f, 176.07295699047839f, 176.93479059943397f, 177.80084267090768f, 178.67113385323105f, 179.54568489580393f, 180.42451664958949f, 181.30765006761115f, 182.19510620545222f, 183.08690622175786f, 183.98307137873957f, 184.88362304268219f, 185.78858268445313f, 186.69797188001451f, 187.61181231093738f, 188.53012576491869f, 189.45293413630088f, 190.38025942659371f, 191.3121237449989f, 192.2485493089373f, 193.18955844457847f, 194.13517358737312f, 195.08541728258788f, 196.04031218584296f, 196.99988106365217f, 197.96414679396582f, 198.93313236671611f, 199.90686088436527f, 200.8853555624564f, 201.86863973016696f, 202.85673683086489f, 203.84967042266769f, 204.84746417900399f, 205.85014188917808f, 206.85772745893686f, 207.87024491104012f, 208.88771838583301f, 209.91017214182176f, 210.93763055625195f, 211.97011812568979f, 213.00765946660613f, 214.05027931596331f, 215.09800253180504f, 216.15085409384898f, 217.20885910408234f, 218.27204278736039f, 219.34043049200781f, 220.41404769042299f, 221.49291997968555f, 222.57707308216638f, 223.66653284614108f, 224.76132524640613f, 225.86147638489825f, 226.96701249131667f, 228.07795992374852f, 229.19434516929726f, 230.3161948447142f, 231.44353569703298f, 232.57639460420748f, 233.71479857575241f, 234.85877475338745f, 236.00835041168426f, 237.16355295871682f, 238.32440993671483f, 239.49094902272037f, 240.66319802924787f, 241.84118490494708f, 243.02493773526956f, 244.21448474313812f, 245.40985428961983f, 246.61107487460225f, 247.81817513747276f, 249.03118385780147f, 250.25012995602742f, 251.47504249414803f, 252.70595067641196f, 253.94288385001556f, 255.18587150580237f, 256.43494327896633f, 257.69012894975839f, 258.95145844419636f, 260.21896183477855f, 261.49266934120089f, 262.77261133107692f, 264.05881832066245f, 265.35132097558261f, 266.65015011156339f, 267.9553366951659f, 269.26691184452505f, 270.58490683009143f, 271.90935307537654f, 273.24028215770232f, 274.57772580895397f, 275.92171591633621f, 277.27228452313398f, 278.62946382947604f, 279.99328619310285f, 281.36378413013801f, 282.74099031586354f, 284.12493758549891f, 285.51565893498378f, 286.91318752176483f, 288.31755666558627f, 289.72879984928426f, 291.14695071958505f, 292.57204308790733f, 294.00411093116844f, 295.44318839259415f, 296.88930978253313f, 298.34250957927446f, 299.8028224298701f, 301.27028315096072f, 302.74492672960582f, 304.22678832411788f, 305.71590326490076f, 307.21230705529177f, 308.71603537240833f, 310.2271240679986f, 311.74560916929607f, 313.27152687987871f, 314.80491358053206f, 316.3458058301166f, 317.89424036643936f, 319.45025410712992f, 321.01388415052048f, 322.5851677765304f, 324.16414244755515f, 325.75084580935913f, 327.34531569197372f, 328.94759011059881f, 330.55770726650928f, 332.17570554796589f, 333.80162353113042f, 335.43549998098536f, 337.07737385225829f, 338.72728429035055f, 340.38527063227053f, 342.05137240757148f, 343.72562933929424f, 345.40808134491385f, 347.09876853729179f, 348.79773122563188f, 350.50500991644162f, 352.22064531449786f, 353.94467832381724f, 355.67715004863146f, 357.41810179436732f, 359.16757506863138f, 360.92561158219979f, 362.69225325001258f, 364.46754219217303f, 366.25152073495195f, 368.04423141179677f, 369.84571696434568f, 371.65602034344653f, 373.47518471018111f, 375.30325343689378f, 377.1402701082261f, 378.98627852215554f, 380.84132269103975f, 382.70544684266622f, 384.57869542130629f, 386.46111308877522f, 388.35274472549673f, 390.25363543157306f, 392.1638305278604f, 394.08337555704935f, 396.01231628475063f, 397.95069870058632f, 399.89856901928647f, 401.85597368179066f, 403.82295935635545f, 405.79957293966703f, 407.78586155795915f, 409.78187256813692f, 411.78765355890584f, 413.80325235190622f, 415.82871700285369f, 417.86409580268446f, 419.90943727870717f, 421.96479019575952f, 424.03020355737107f, 426.10572660693163f, 428.19140882886506f, 430.28729994980938f, 432.39344993980217f, 434.50990901347194f, 436.63672763123554f, 438.77395650050101f, 440.92164657687653f, 443.07984906538547f, 445.24861542168725f, 447.42799735330379f, 449.61804682085273f, 451.81881603928605f, 454.03035747913492f, 456.25272386776095f, 458.48596819061299f, 460.7301436924908f, 462.98530387881397f, 465.25150251689814f, 467.5287936372365f, 469.81723153478839f, 472.11687077027324f, 474.427766171472f, 476.74997283453382f, 479.08354612529013f, 481.4285416805742f, 483.78501540954795f, 486.15302349503486f, 488.53262239485935f, 490.92386884319308f, 493.32681985190726f, 495.74153271193234f, 498.16806499462353f, 500.60647455313369f, 503.05681952379257f, 505.51915832749285f, 507.99354967108309f, 510.48005254876722f, 512.97872624351146f, 515.48963032845722f, 518.01282466834198f, 520.54836942092618f, 523.09632503842761f, 525.6567522689628f, 528.22971215799521f, 530.81526604979081f, 533.4134755888806f, 536.02440272153035f, 538.64810969721725f, 541.2846590701148f, 543.93411370058323f, 546.5965367566688f, 549.27199171561006f, 551.96054236535053f, 554.66225280606034f, 557.37718745166364f, 560.1054110313753f, 562.84698859124342f, 565.60198549570043f, 568.37046742912173f, 571.15250039739124f, 573.94815072947551f, 576.75748507900482f, 579.5805704258629f, 582.41747407778291f, 585.26826367195326f, 588.13300717662923f, 591.01177289275415f, 593.90462945558761f, 596.81164583634165f, 599.73289134382571f, 602.66843562609813f, 605.61834867212792f, 608.58270081346245f, 611.56156272590454f, 614.55500543119797f, 617.56310029871997f, 620.58591904718355f, 623.62353374634699f, 626.67601681873214f, 629.7434410413515f, 632.82587954744258f, 635.92340582821237f, 639.03609373458903f, 642.16401747898294f, 645.30725163705551f, 648.46587114949807f, 651.63995132381763f, 654.82956783613304f, 658.0347967329792f, 661.25571443311992f, 664.49239772936971f, 667.74492379042522f, 671.01337016270486f, 674.29781477219728f, 677.59833592631981f, 680.91501231578525f, 684.24792301647778f, 687.59714749133866f, 690.96276559226078f, 694.34485756199183f, 697.74350403604842f, 701.15878604463762f, 704.59078501458987f, 708.03958277129937f, 711.50526154067552f, 714.98790395110348f, 718.48759303541351f, 722.00441223286123f, 725.53844539111708f, 729.08977676826464f, 732.65849103481037f, 736.24467327570176f, 739.84840899235598f, 743.46978410469876f, 747.10888495321251f, 750.76579830099502f, 754.44061133582773f, 758.13341167225519f, 761.84428735367305f, 765.57332685442793f, 769.32061908192634f, 773.08625337875458f, 776.87031952480902f, 780.67290773943614f, 784.49410868358393f, 788.33401346196354f, 792.1927136252209f, 796.0703011721198f, 799.96686855173516f, 803.8825086656575f, 807.81731487020738f, 811.7713809786618f, 815.74480126349022f, 819.73767045860279f, 823.75008376160861f, 827.78213683608567f, 831.83392581386147f, 835.90554729730491f, 839.99709836162981f, 844.10867655720904f, 848.24037991190062f, 852.39230693338436f, 856.56455661151131f, 860.75722842066284f, 864.97042232212323f, 869.20423876646237f, 873.45877869593085f, 877.73414354686679f, 882.03043525211399f, 886.34775624345218f, 890.68620945403973f, 895.04589832086697f, 899.4269267872229f, 903.82939930517341f, 908.25342083805106f, 912.69909686295841f, 917.16653337328205f, 921.65583688122001f, 926.16711442032147f, 930.70047354803808f, 935.25602234828875f, 939.83386943403661f, 944.43412394987809f, 949.05689557464586f, 953.70229452402282f, 958.37043155317099f, 963.06141795937106f, 967.77536558467659f, 972.51238681858047f, 977.27259460069433f, 982.05610242344096f, 986.86302433476101f, 991.69347494083138f, 996.5475694087977f, 1001.4254234695205f, 1006.3271534203345f, 1011.2528761278207f, 1016.2027090305934f, 1021.1767701420997f, 1026.1751780534337f, 1031.1980519361632f, 1036.2455115451714f, 1041.3176772215127f, 1046.4146698952802f, 1051.5366110884906f, 1056.6836229179808f, 1061.8558280983193f, 1067.053349944732f, 1072.2763123760424f, 1077.5248399176262f, 1082.7990577043797f, 1088.0990914837041f, 1093.4250676185027f, 1098.7771130901938f, 1104.1553555017385f, 1109.5599230806836f, 1114.9909446822167f, 1120.4485497922406f, 1125.9328685304595f, 1131.4440316534813f, 1136.9821705579348f, 1142.5474172836036f, 1148.1399045165731f, 1153.7597655923937f, 1159.407134499261f, 1165.08214588121f, 1170.7849350413237f, 1176.515637944962f, 1182.2743912230001f, 1188.0613321750884f, 1193.8765987729248f, 1199.7203296635448f, 1205.5926641726269f, 1211.493742307814f, 1217.4237047620525f, 1223.3826929169447f, 1229.3708488461227f, 1235.3883153186323f, 1241.4352358023393f, 1247.5117544673494f, 1253.6180161894447f, 1259.7541665535391f, 1265.920351857148f, 1272.1167191138777f, 1278.3434160569291f, 1284.6005911426212f, 1290.8883935539295f, 1297.2069732040436f, 1303.556480739941f, 1309.9370675459788f, 1316.3488857475036f, 1322.7920882144774f, 1329.2668285651232f, 1335.7732611695872f, 1342.3115411536189f, 1348.8818244022709f, 1355.4842675636137f, 1362.119028052472f, 1368.7862640541766f, 1375.4861345283371f, 1382.2187992126305f, 1388.9844186266107f, 1395.7831540755346f, 1402.6151676542092f, 1409.4806222508548f, 1416.3796815509895f, 1423.3125100413322f, 1430.2792730137226f, 1437.2801365690636f, 1444.3152676212812f, 1451.3848339013034f, 1458.4890039610598f, 1465.6279471775003f, 1472.8018337566327f, 1480.0108347375813f, 1487.2551219966645f, 1494.5348682514932f, 1501.8502470650881f, 1509.2014328500177f, 1516.5886008725572f, 1524.0119272568672f, 1531.471588989192f, 1538.9677639220799f, 1546.5006307786239f, 1554.0703691567219f, 1561.6771595333594f, 1569.3211832689117f, 1577.0026226114692f, 1584.7216607011808f, 1592.4784815746216f, 1600.27327016918f, 1608.1062123274673f, 1615.9774948017489f, 1623.8873052583956f, 1631.835832282359f, 1639.8232653816679f, 1647.8497949919456f, 1655.9156124809504f, 1664.0209101531393f, 1672.1658812542516f, 1680.3507199759167f, 1688.5756214602841f, 1696.840781804676f, 1705.1463980662625f, 1713.4926682667597f, 1721.8797913971512f, 1730.3079674224321f, 1738.7773972863772f, 1747.2882829163307f, 1755.8408272280219f, 1764.4352341304023f, 1773.0717085305068f, 1781.7504563383404f, 1790.4716844717859f, 1799.2356008615388f, 1808.0424144560632f, 1816.8923352265747f, 1825.7855741720462f, 1834.7223433242382f, 1843.7028557527542f, 1852.7273255701211f, 1861.7959679368932f, 1870.9089990667833f, 1880.0666362318159f, 1889.269097767509f, 1898.516603078079f, 1907.8093726416716f, 1917.1476280156185f, 1926.5315918417198f, 1935.961487851552f, 1945.4375408718029f, 1954.9599768296307f, 1964.5290227580517f, 1974.1449068013526f, 1983.8078582205299f, 1993.518107398756f, 2003.2758858468721f, 2013.0814262089077f, 2022.9349622676273f, 2032.8367289501043f, 2042.786962333322f, 2052.7858996498021f, 2062.8337792932616f, 2072.9308408242946f, 2083.0773249760859f, 2093.2734736601496f, 2103.5195299720967f, 2113.8157381974315f, 2124.1623438173756f, 2134.5595935147189f, 2145.0077351797054f, 2155.5070179159379f, 2166.0576920463213f, 2176.6600091190289f, 2187.3142219135002f, 2198.0205844464672f, 2208.7793519780116f, 2219.5907810176495f, 2230.455129330448f, 2241.3726559431707f, 2252.3436211504531f, 2263.3682865210085f, 2274.4469149038637f, 2285.5797704346282f, 2296.7671185417885f, 2308.0092259530384f, 2319.3063607016384f, 2330.6587921328046f, 2342.0667909101326f, 2353.5306290220478f, 2365.0505797882934f, 2376.6269178664438f, 2388.2599192584553f, 2399.949861317245f, 2411.6970227533043f, 2423.5016836413438f, 2435.3641254269692f, 2447.284630933395f, 2459.263484368184f, 2471.3009713300253f, 2483.3973788155427f, 2495.5529952261372f, 2507.768110374865f, 2520.0430154933433f, 2532.3780032386981f, 2544.7733677005385f, 2557.2294044079699f, 2569.7464103366397f, 2582.3246839158178f, 2594.9645250355111f, 2607.6662350536144f, 2620.4301168030952f, 2633.2564745992127f, 2646.145614246775f, 2659.0978430474283f, 2672.113469806985f, 2685.1928048427853f, 2698.3361599910968f, 2711.5438486145476f, 2724.8161856095985f, 2738.1534874140516f, 2751.5560720145932f, 2765.024258954375f, 2778.5583693406352f, 2792.1587258523514f, 2805.8256527479352f, 2819.559475872963f, 2833.3605226679456f, 2847.2291221761325f, 2861.1656050513598f, 2875.1703035659325f, 2889.243551618546f, 2903.3856847422471f, 2917.5970401124346f, 2931.8779565548962f, 2946.2287745538902f, 2960.6498362602592f, 2975.1414854995905f, 2989.704067780413f, 3004.337930302434f, 3019.0434219648173f, 3033.8208933745027f, 3048.6706968545636f, 3063.5931864526074f, 3078.5887179492188f, 3093.6576488664382f, 3108.8003384762901f, 3124.0171478093453f, 3139.3084396633308f, 3154.6745786117785f, 3170.1159310127177f, 3185.63286501741f, 3201.2257505791258f, 3216.8949594619658f, 3232.6408652497244f, 3248.4638433547952f, 3264.3642710271242f, 3280.3425273632015f, 3296.3989933151011f, 3312.5340516995634f, 3328.7480872071219f, 3345.0414864112759f, 3361.4146377777056f, 3377.8679316735347f, 3394.4017603766388f, 3411.0165180849945f, 3427.7126009260819f, 3444.4904069663271f, 3461.3503362205915f, 3478.2927906617124f, 3495.3181742300831f, 3512.4268928432866f, 3529.619354405771f, 3546.8959688185764f, 3564.2571479891076f, 3581.7033058409534f, 3599.2348583237572f, 3616.8522234231327f, 3634.5558211706293f, 3652.3460736537486f, 3670.2234050260045f, 3688.1882415170385f, 3706.2410114427803f, 3724.3821452156608f, 3742.612075354873f, 3760.9312364966845f, 3779.3400654048f, 3797.8390009807749f, 3816.4284842744783f, 3835.1089584946108f, 3853.8808690192695f, 3872.7446634065659f, 3891.7007914053002f, 3910.7497049656804f, 3929.8918582500987f, 3949.1277076439605f, 3968.4577117665663f, 3987.882331482042f, 4007.4020299103317f, 4027.017272438236f, 4046.7285267305097f, 4066.5362627410104f, 4086.440952723904f, 4106.4430712449239f, 4126.5430951926837f, 4146.7415037900528f, 4167.0387786055744f, 4187.4354035649521f, 4207.9318649625875f, 4228.5286514731697f, 4249.2262541633336f, 4270.0251665033611f, 4290.9258843789503f, 4311.9289061030368f, 4333.0347324276754f, 4354.2438665559794f, 4375.5568141541135f, 4396.9740833633568f, 4418.496184812213f, 4440.1236316285858f, 4461.8569394520155f, 4483.6966264459661f, 4505.6432133101871f, 4527.6972232931248f, 4549.8591822043954f, 4572.1296184273242f, 4594.5090629315418f, 4616.9980492856439f, 4639.5971136699145f, 4662.3067948891057f, 4685.1276343852851f, 4708.0601762507467f, 4731.1049672409818f, 4754.2625567877139f, 4777.5334970120002f, 4800.9183427373928f, 4824.4176515031677f, 4848.0319835776208f, 4871.7619019714184f, 4895.6079724510291f, 4919.5707635522049f, 4943.6508465935422f, 4967.8487956900999f, 4992.1651877670884f, 5016.6006025736242f, 5041.1556226965531f, 5065.8308335743386f, 5090.626823511021f, 5115.5441836902437f, 5140.5835081893483f, 5165.7453939935376f, 5191.0304410101098f, 5216.4392520827605f, 5241.9724330059562f, 5267.630592539379f, 5293.4143424224376f, 5319.3242973888546f, 5345.3610751813221f, 5371.5252965662294f, 5397.8175853484654f, 5424.2385683862885f, 5450.788875606273f, 5477.4691400183301f, 5504.2799977307959f, 5531.2220879655997f, 5558.2960530735072f, 5585.5025385494282f, 5612.8421930478125f, 5640.3156683981133f, 5667.9236196203283f, 5695.6667049406142f, 5723.5455858069845f, 5751.5609269050765f, 5779.7133961739974f, 5808.0036648222531f, 5836.432407343751f, 5865.0003015338752f, 5893.7080285056545f, 5922.556272705996f, 5951.5457219320051f, 5980.6770673473839f, 6009.9510034989107f, 6039.368228332999f, 6068.929443212337f, 6098.6353529326088f, 6128.4866657393004f, 6158.4840933445848f, 6188.6283509442892f, 6218.9201572349484f, 6249.3602344309384f, 6279.9493082816962f, 6310.6881080890244f, 6341.5773667244739f, 6372.6178206468257f, 6403.8102099196412f, 6435.1552782289109f, 6466.6537729007841f, 6498.306444919388f, 6530.1140489447298f, 6562.0773433306922f, 6594.1970901431123f, 6626.4740551779514f, 6658.9090079795524f, 6691.5027218589876f, 6724.2559739124972f, 6757.169545040013f, 6790.2442199637799f, 6823.4807872470656f, 6856.8800393129595f, 6890.4427724632642f, 6924.1697868974852f, 6958.0618867319063f, 6992.1198800187613f, 7026.3445787655f, 7060.736798954149f, 7095.2973605607622f, 7130.0270875749784f, 7164.926808019658f, 7199.9973539706298f, 7235.2395615765299f, 7270.6542710787326f, 7306.2423268313887f, 7342.0045773215506f, 7377.9418751894091f, 7414.0550772486149f, 7450.345044506711f, 7486.8126421856587f, 7523.4587397424693f, 7560.2842108899276f, 7597.2899336174305f, 7634.4767902119129f, 7671.845667278888f, 7709.3974557635829f, 7747.1330509721811f, 7785.0533525931705f, 7823.159264718789f, 7861.4516958665863f, 7899.9315590010765f, 7938.5997715555131f, 7977.4572554537563f, 8016.5049371322575f, 8055.7437475621437f, 8095.1746222714164f, 8134.7985013672569f, 8174.6163295584365f, 8214.6290561778424f, 8254.8376352051146f, 8295.2430252893846f, 8335.8461897721354f, 8376.6480967101688f, 8417.6497188986868f, 8458.8520338944782f, 8500.2560240392395f, 8541.8626764829769f, 8583.6729832075598f, 8625.6879410503625f, 8667.9085517280255f, 8710.3358218603535f, 8752.9707629942986f, 8795.8143916280933f, 8838.8677292354696f, 8882.1318022900286f, 8925.6076422896967f, 8969.2962857813382f, 9013.1987743854497f, 9057.3161548210082f, 9101.6494789304179f, 9146.1998037045942f, 9190.9681913081586f, 9235.95570910477f, 9281.1634296825632f, 9326.5924308797348f, 9372.2437958102255f, 9418.1186128895533f, 9464.2179758607635f, 9510.5429838205f, 9557.0947412452169f, 9603.8743580175014f, 9650.8829494525507f, 9698.121636324744f, 9745.5915448943833f, 9793.2938069345291f, 9841.2295597579978f, 9889.3999462444644f, 9937.8061148677243f, 9986.4492197230629f, 10035.330420554777f, 10084.450882783831f, 10133.811777535628f, 10183.414281667949f, 10233.259577798997f, 10283.348854335602f, 10333.683305501549f, 10384.264131366057f, 10435.092537872384f, 10486.169736866585f, 10537.496946126399f, 10589.075389390287f, 10640.906296386609f, 10692.990902862941f, 10745.330450615535f, 10797.926187518931f, 10850.779367555708f, 10903.891250846376f, 10957.263103679428f, 11010.896198541523f, 11064.791814147828f, 11118.951235472505f, 11173.375753779348f, 11228.066666652569f, 11283.02527802773f, 11338.252898222836f, 11393.750843969581f, 11449.520438444728f, 11505.563011301667f, 11561.879898702109f, 11618.472443347953f, 11675.341994513286f, 11732.489908076561f, 11789.917546552919f, 11847.626279126678f, 11905.617481683972f, 11963.892536845562f, 12022.452833999791f, 12081.299769335719f, 12140.434745876402f, 12199.859173512352f, 12259.574469035142f, 12319.582056171193f, 12379.883365615713f, 12440.47983506681f, 12501.372909259768f, 12562.564040001495f, 12624.054686205132f, 12685.846313924847f, 12747.94039639077f, 12810.338414044134f, 12873.041854572568f, 12936.05221294556f, 12999.370991450107f, 13062.999699726528f, 13126.939854804457f, 13191.192981139018f, 13255.760610647163f, 13320.644282744195f, 13385.845544380483f, 13451.365950078327f, 13517.207061969037f, 13583.370449830165f, 13649.857691122936f, 13716.670371029861f, 13783.810082492524f, 13851.278426249568f, 13919.077010874853f, 13987.207452815814f, 14055.67137643199f, 14124.470414033767f, 14193.606205921282f, 14263.080400423536f, 14332.894653937694f, 14403.050630968573f, 14473.550004168337f, 14544.394454376361f, 14615.585670659315f, 14687.125350351438f, 14759.015199094996f, 14831.256930880951f, 14903.852268089833f, 14976.802941532791f, 15050.110690492877f, 15123.777262766493f, 15197.804414705079f, 15272.19391125698f, 15346.947526009528f, 15422.067041231323f, 15497.554247914732f, 15573.410945818587f, 15649.638943511094f, 15726.240058412954f, 15803.216116840693f, 15880.568954050204f, 15958.300414280506f, 16036.412350797709f, 16114.906625939208f, 16193.785111158073f, 16273.049687067678f, 16352.702243486536f, 16432.744679483349f, 16513.178903422297f, 16594.006833008523f, 16675.230395333878f, 16756.851526922834f, 16838.87217377868f, 16921.294291429909f, 17004.119844976845f, 17087.350809138494f, 17170.989168299613f, 17255.036916558041f, 17339.49605777223f, 17424.36860560903f, 17509.656583591681f, 17595.362025148079f, 17681.486973659241f, 17768.033482508035f, 17855.003615128127f, 17942.399445053179f, 18030.223055966289f, 18118.476541749675f, 18207.162006534578f, 18296.281564751454f, 18385.83734118037f, 18475.83147100166f, 18566.266099846845f, 18657.143383849783f, 18748.465489698068f, 18840.234594684698f, 18932.45288675998f, 19025.122564583704f, 19118.245837577546f, 19211.824925977762f, 19305.862060888114f, 19400.359484333065f, 19495.319449311231f, 19590.744219849108f, 19686.636071055033f, 19782.99728917344f, 19879.830171639365f, 19977.13702713322f, 20074.920175635834f, 20173.181948483772f, 20271.924688424919f, 20371.150749674322f, 20470.862497970338f, 20571.062310631027f, 20671.752576610827f, 20772.935696557524f, 20874.614082869481f, 20976.790159753149f, 21079.466363280881f, 21182.645141448993f, 21286.328954236142f, 21390.520273661969f, 21495.221583846043f, 21600.435381067091f, 21706.16417382249f, 21812.410482888106f, 21919.176841378383f};

static inline float loclap_fastexp(float x) 
{
  if (x < -9.f) { return expf(x); } if (x > 9.f) { return expf(x); } return _loclap_fastexp[(int)(x * 0.05f * 4096) + 2048];
}

static void loclap_get_max_min(float *in, const int size, float * max, float * min)
{
  float maximum = 0.f;
  float minimum = 0.f;
  
#ifdef _OPENMP
#pragma omp parallel for default(none) shared(in) schedule(static) reduction(max : maximum) reduction(min : minimum)
#endif
  for (int i = 0; i < size; i++) 
  {
  	maximum = MAX(in[i], maximum);
    minimum = MIN(in[i], minimum);
  }
  
  *max = maximum;
  *min = minimum;
}

static void loclap_gaussian_blur(_loclap_image_t * im_src, const float sigma) 
{
	
	float Labmax[] = { INFINITY, INFINITY, INFINITY, INFINITY };
	float Labmin[] = { -INFINITY, -INFINITY, -INFINITY, -INFINITY };

	dt_gaussian_t *g = dt_gaussian_init(im_src->width, im_src->height, 1, Labmax, Labmin, sigma, DT_IOP_GAUSSIAN_ZERO);
	if(g)
	{
		dt_gaussian_blur(g, im_src->im, im_src->im);
		dt_gaussian_free(g);
	}
	
}

static void loclap_fast_blur_calculate_coefficients(const float sigma, float *c0, float *c1, float *c2, float *c3) 
{
  // performs the necessary conversion between the sigma of a Gaussian blur
  // and the coefficients used in the IIR filter

  float q;

  g_assert(sigma >= 0.5f); // "To use IIR filtering, standard deviation of blur must be >= 0.5\n"

  if (sigma < 2.5f) 
  {
    q = (3.97156 - 4.14554 * sqrtf(1 - 0.26891 * sigma));
  } else 
  {
    q = 0.98711 * sigma - 0.96330;
  }

  const float denom = 1.57825 + 2.44413 * q + 1.4281 * q * q
      + 0.422205 * q * q * q;
  *c1 = (2.44413 * q + 2.85619 * q * q + 1.26661 * q * q * q) / denom;
  *c2 = -(1.4281 * q * q + 1.26661 * q * q * q) / denom;
  *c3 = (0.422205 * q * q * q) / denom;
  *c0 = 1 - (*c1 + *c2 + *c3);
}

static void loclap_fast_blur_blurX(_loclap_image_t * im, const float sigma, const int ts) 
{
  if (sigma == 0) { return; }

  // blur in the x-direction
  float c0, c1, c2, c3;
  loclap_fast_blur_calculate_coefficients(sigma, &c0, &c1, &c2, &c3);

  float invC01 = 1.0f/(c0+c1);
  float invC012 = 1.0f/(c0+c1+c2);

  // we step through each row of each frame, and apply a forwards and then
  // a backwards pass of our IIR filter to approximate Gaussian blurring
  // in the x-direction
  for (int y = 0; y < im->height; y++) 
  {
    float *in = im->im + y*im->width;
    
		// forward pass

		// use a zero boundary condition in the homogeneous
		// sense (ie zero weight outside the image, divide by
		// the sum of the weights)
		for (int j = 0; j < ts; j++) 
		{
			in[(ts+j)] = (c0*in[(ts+j)] + c1*in[j]) * invC01;
			in[(2*ts+j)] = (c0*in[(2*ts+j)] + c1*in[(ts+j)] + c2*in[j]) * invC012;
		}

		// now apply the forward filter
		for (int x = 3*ts; x < im->width; x++) 
		{
			in[x] = (c0 * in[x] +
					c1 * in[(x-ts)] +
					c2 * in[(x-2*ts)] + 
					c3 * in[(x-3*ts)]);
		}

		// use a zero boundary condition in the homogeneous
		// sense
		const int x = im->width-3*ts;
		for (int j = 0; j < ts; j++) 
		{
			in[(x+ts+j)] = (c0*in[(x+ts+j)] + c1*in[(x+2*ts+j)]) * invC01;
			in[(x+j)] = (c0*in[(x+j)] + c1*in[(x+ts+j)] + c2*in[(x+2*ts+j)]) * invC012;
		}

		// backward pass
		for (int x1 = im->width-3*ts-1; x1 >= 0; x1--) 
		{
			in[x1] = (c0 * in[x1] + 
					c1 * in[(x1+ts)] + 
					c2 * in[(x1+2*ts)] + 
					c3 * in[(x1+3*ts)]);
		}
  }
}

static void loclap_fast_blur_blurY(_loclap_image_t * im, const float sigma, const int ts) 
{
  if (sigma == 0.f) { return; }

  float c0, c1, c2, c3;
  loclap_fast_blur_calculate_coefficients(sigma, &c0, &c1, &c2, &c3);
  const float invC01 = 1.0f/(c0+c1);
  const float invC012 = 1.0f/(c0+c1+c2);

  // blur in the y-direction
  //  we do the same thing here as in the x-direction
  //  but we apply im.width different filters in parallel,
  //  for cache coherency's sake, first all going in the "forwards"
  //  direction, and then all going in the "backwards" direction
  // use a zero boundary condition in the homogeneous
  // sense (ie zero weight outside the image, divide by
  // the sum of the weights)
  for (int j = 0; j < ts; j++) 
  {
    for (int x = 0; x < im->width; x++) 
    {
      im->im[x + (ts+j)*im->width] = (c0*im->im[x + (ts+j)*im->width] + c1*im->im[x + j*im->width]) * invC01;
      im->im[x + (2*ts+j)*im->width] = (c0*im->im[x + (2*ts+j)*im->width] + c1*im->im[x + (ts+j)*im->width] + c2*im->im[x + j*im->width]) * invC012;
    }
  }

  // forward pass
  for (int y = 3*ts; y < im->height; y++) 
  {
    for (int x = 0; x < im->width; x++) 
    {
      im->im[x + y*im->width] = (c0 * im->im[x + y*im->width] + 
          c1 * im->im[x + (y-ts)*im->width] + 
          c2 * im->im[x + (y-2*ts)*im->width] + 
          c3 * im->im[x + (y-3*ts)*im->width]);
    }
  }

  // use a zero boundary condition in the homogeneous
  // sense (ie zero weight outside the image, divide by
  // the sum of the weights)
  const int y = im->height-3*ts;
  for (int j = 0; j < ts; j++) 
  {
    for (int x = 0; x < im->width; x++) 
    {
      im->im[x + (y+ts+j)*im->width] = (c0*im->im[x + (y+ts+j)*im->width] + c1*im->im[x + (y+ts*2+j)*im->width]) * invC01;
      im->im[x + (y+j)*im->width] = (c0*im->im[x + (y+j)*im->width] + c1*im->im[x + (y+ts+j)*im->width] + c2*im->im[x + (y+ts*2+j)*im->width]) * invC012;
    }
  }

  // backward pass
  for (int y1 = im->height-3*ts-1; y1 >= 0; y1--) 
  {
    for (int x = 0; x < im->width; x++) 
    {
      im->im[x + y1*im->width] = (c0 * im->im[x + y1*im->width] + 
          c1 * im->im[x + (y1+ts)*im->width] + 
          c2 * im->im[x + (y1+2*ts)*im->width] + 
          c3 * im->im[x + (y1+3*ts)*im->width]);
    }
  }

}

static void loclap_fast_blur(_loclap_image_t * im, float filterWidth, float filterHeight) 
{
  // Prevent filtering in useless directions
  if (im->width == 1) filterWidth = 0.f;
  if (im->height == 1) filterHeight = 0.f;

  // Filter in very narrow directions using the regular Gaussian, as
  // the IIR requires a few pixels to get going. If the Gaussian
  // blur is very narrow, also revert to the naive method, as IIR
  // won't work.
  if (filterWidth > 0.f && (im->width < 16 || filterWidth < 0.5f)) 
  {
  	loclap_gaussian_blur(im, filterWidth);
  	
/*    _loclap_image_t blurry = { NULL, 0, 0 };
    blurry.width = im->width;
    blurry.height = im->height;
    blurry.im = dt_alloc_align(64, blurry.width * blurry.height * sizeof(float));
      
    loclap_gaussian_blur(im, &blurry, filterWidth, 0);
    loclap_fast_blur(&blurry, 0, filterHeight);
    loclap_paste_image_2(im, &blurry, 0, 0);
    
    if (blurry.im)
    {
      dt_free_align(blurry.im);
      blurry.im = NULL;
    }*/
  	
    return;
  }

  if (filterHeight > 0.f && (im->height < 16 || filterHeight < 0.5f)) 
  {
    loclap_gaussian_blur(im, filterHeight);
    
/*    _loclap_image_t blurry = { NULL, 0, 0 };
    blurry.width = im->width;
    blurry.height = im->height;
    blurry.im = dt_alloc_align(64, blurry.width * blurry.height * sizeof(float));
      
    loclap_gaussian_blur(im, &blurry, 0, filterHeight);
    loclap_fast_blur(&blurry, filterWidth, 0);
    loclap_paste_image_2(im, &blurry, 0, 0);
    
    if (blurry.im)
    {
      dt_free_align(blurry.im);
      blurry.im = NULL;
    }*/
    
    return;
  }

  // now perform the blur
  if (filterWidth > 32) 
  {
  	printf("filterWidth > 32\n");
  	
    // for large filters, we decompose into a dense blur and a
    // sparse blur, by spacing out the taps on the IIR
    float remainingStdDev = sqrtf(filterWidth*filterWidth - 32*32);
    int tapSpacing = (int)(remainingStdDev / 32 + 1);
    loclap_fast_blur_blurX(im, remainingStdDev/tapSpacing, tapSpacing);
    loclap_fast_blur_blurX(im, 32, 1);
  } 
  else if (filterWidth > 0.f) 
  {
    loclap_fast_blur_blurX(im, filterWidth, 1.f);
  }

  if (filterHeight > 32) 
  {
  	printf("filterHeight > 32\n");
  	
    float remainingStdDev = sqrtf(filterHeight*filterHeight - 32*32);
    int tapSpacing = (int)(remainingStdDev / 32 + 1);
    loclap_fast_blur_blurY(im, remainingStdDev/tapSpacing, tapSpacing);
    loclap_fast_blur_blurY(im, 32, 1);
  } 
  else if (filterHeight > 0.f) 
  {
    loclap_fast_blur_blurY(im, filterHeight, 1.f);
  }

}

static void loclap_pyramid_down(_loclap_image_t *im_src, _loclap_image_t *im_dest, const float preview_scale) 
{
  _loclap_image_t smaller = {0};
  _loclap_image_t blurry = {0};

  if (im_dest->im != NULL)
  {
  	printf("loclap_pyramid_down im_dest->im must be NULL\n");
  	goto cleanup;
  }

  smaller.width = ((im_src->width+1)/2);
  smaller.height = ((im_src->height+1)/2);
  smaller.im = dt_alloc_align(64, smaller.width * smaller.height * sizeof(float));
  if (smaller.im == NULL)
  {
  	printf("loclap_pyramid_down() Error allocating memory for smaller image\n");
  	goto cleanup;
  }
  
  memset(smaller.im, 0, smaller.width * smaller.height * sizeof(float));

  blurry.width = im_src->width;
  blurry.height = im_src->height;
  blurry.im = dt_alloc_align(64, blurry.width * blurry.height * sizeof(float));
  if (blurry.im == NULL)
  {
  	printf("loclap_pyramid_down() Error allocating memory for blurry image\n");
  	goto cleanup;
  }

  memcpy(blurry.im, im_src->im, im_src->width * im_src->height * sizeof(float));

  loclap_fast_blur(&blurry, 1.f/preview_scale, 1.f/preview_scale);

#ifdef _OPENMP
#pragma omp parallel for default(none) shared(blurry, smaller, im_src) schedule(static)
#endif
  for (int y = 0; y < im_src->height; y++) 
  {
    float *bl =  blurry.im + y*blurry.width;
    float *sm = smaller.im + (y/2)*smaller.width;
    
    for (int x = 0; x < im_src->width; x++, bl++) 
    {
        sm[(x/2)] += bl[0];
    }
  }

  const float scale[4] = {0.125f, 0.25f, 0.5f, 1.0f};
  const int tFactor = 1;
  
#ifdef _OPENMP
#pragma omp parallel for default(none) shared(smaller, im_src) schedule(static)
#endif
  for (int y = 0; y < smaller.height; y++) 
  {
    float *sm = smaller.im + y*smaller.width;

    const int yFactor = ((y*2+1) < im_src->height) ? tFactor : (tFactor+1);
    for (int x = 0; x < smaller.width; x++, sm++) 
    {
        const int xFactor = ((x*2+1) < im_src->width) ? (yFactor) : (yFactor+1);
        sm[0] *= scale[xFactor];
    }
  }

  im_dest->im = smaller.im;
  im_dest->width = smaller.width;
  im_dest->height = smaller.height;

cleanup:
  if (blurry.im) dt_free_align(blurry.im);

}

static void loclap_pyramid_up(_loclap_image_t *im_src, _loclap_image_t *im_dest, const int bAdd, const float preview_scale) 
{
  _loclap_image_t larger = {0};

  larger.width = im_dest->width;
  larger.height = im_dest->height;
  larger.im = dt_alloc_align(64, larger.width * larger.height * sizeof(float));
  if (larger.im == NULL)
  {
  	printf("loclap_pyramid_up() Error allocating memory for larger image\n");
  	goto cleanup;
  }
  
  memset(larger.im, 0, larger.width * larger.height * sizeof(float));

#ifdef _OPENMP
#pragma omp parallel for default(none) shared(larger, im_src) schedule(static)
#endif
  for (int y = 0; y < larger.height; y++) 
  {
    float *lg = larger.im + y*larger.width;
    float *in = im_src->im + (y/2)*im_src->width;
    
    for (int x = 0; x < larger.width; x++, lg++) 
    {
        lg[0] = in[(x/2)];
    }
  }

 	loclap_fast_blur(&larger, 1.f/preview_scale, 1.f/preview_scale);
  	
  if (bAdd)
  {
#ifdef _OPENMP
#pragma omp parallel for default(none) shared(im_dest, larger) schedule(static)
#endif
    for (int i = 0; i < im_dest->width*im_dest->height; i++)
      im_dest->im[i] += larger.im[i];
  }
  else
  {
#ifdef _OPENMP
#pragma omp parallel for default(none) shared(im_dest, larger) schedule(static)
#endif
    for (int i = 0; i < im_dest->width*im_dest->height; i++)
      im_dest->im[i] -= larger.im[i];
  }

cleanup:
  if (larger.im) dt_free_align(larger.im);

}

static int loclap_get_max_scale(const int width, const int height)
{
  int maxscale = 1;
  
  /* smallest edge must be higher than or equal to 2^scales */
  unsigned int size = MIN(width, height);
  while ((size >>= 1) >= 25) maxscale++;

  return maxscale;
} 

void loclap_LocalLaplacian(float *im_in, float *im_out, const int width, const int height, 
															const float _alpha, const float beta, const float *const scales, const float _preview_scale, const int use_sse)
{
  const int max_scale = loclap_get_max_scale(width, height);
  
  // do nothing on too small images
  if (max_scale < 2)
  {
    memcpy(im_out, im_in, width * height * sizeof(float));
    return;
  }

  const float preview_scale = sqrtf(_preview_scale);
  const float alpha = _alpha * sqrtf(_preview_scale);
  		
#define MAX_K 8
#define MAX_J 8
  
  const int K = MIN(MAX_K, max_scale);
  const int J = MIN(MAX_J, max_scale);
  
  _loclap_image_t processed[MAX_K] = {0};
  _loclap_image_t imPyramid[MAX_J] = {0};
  _loclap_image_t imLPyramid[MAX_J] = {0};
  _loclap_image_t pyramid[MAX_K][MAX_J] = {0};

  // this will hold the original image
  imPyramid[0].width = width;
  imPyramid[0].height = height;
  imPyramid[0].im = im_in;
 
  float maximum, minimum;
  loclap_get_max_min(imPyramid[0].im, width*height, &maximum, &minimum);
  
  // Compute a discretized set of K intensities that span the values in the image
  float target[MAX_K] = {0};
  for (int k = 0; k < K; k++) 
  {
    target[k] = ((float)k)/(K-1) * (maximum - minimum) + minimum;
  }

  float sigma = 1.0f/(target[1] - target[0]);
  sigma = - sigma * sigma * 0.5f;

  // Make a set of K processed images
  // printf("Computing different processed images\n");

  for (int k = 0; k < K; k++) 
  {
    processed[k].width = width;
    processed[k].height = height;
    processed[k].im = dt_alloc_align(64, processed[k].width * processed[k].height * sizeof(float));
    if (processed[k].im == NULL)
    {
    	printf("loclap_LocalLaplacian() Error allocating memory for processed images\n");
    	goto cleanup;
    }
    
    memcpy(processed[k].im, imPyramid[0].im, width * height * sizeof(float));
    
#ifdef _OPENMP
#pragma omp parallel for default(none) shared(processed, k, target, sigma) schedule(static)
#endif
		for (int i = 0; i < processed[k].width*processed[k].height; i++)
		{
			// Attract (or repel for negative alpha) the luminance towards the target value
			const float v = processed[k].im[i] - target[k];
			const float adjustment = alpha * v * loclap_fastexp(sigma*v*v);
			
			processed[k].im[i] += adjustment;
		}
	}

  // Compute a J-level laplacian pyramid per processed image
  // printf("Computing their laplacian pyramids\n");
    
#ifdef _OPENMP
#pragma omp parallel for default(none) shared(pyramid, processed) schedule(static)
#endif
  for (int k = 0; k < K; k++) 
  {
    pyramid[k][0] = processed[k];
    for (int j = 1; j < J; j++) 
    {
      loclap_pyramid_down(&pyramid[k][j-1], &pyramid[k][j], preview_scale);
      loclap_pyramid_up(&pyramid[k][j], &pyramid[k][j-1], 0, preview_scale);
    }
  }


  // Now compute a Gaussian and Laplacian pyramid for the input
  // printf("Computing Gaussian pyramid for input\n");

  imLPyramid[0].width = width;
  imLPyramid[0].height = height;
  imLPyramid[0].im = dt_alloc_align(64, width * height * sizeof(float));
  if (imLPyramid[0].im == NULL)
  {
  	printf("loclap_LocalLaplacian() Error allocating memory for imLPyramid[0]\n");
  	goto cleanup;
  }
  
  memcpy(imLPyramid[0].im, imPyramid[0].im, width * height * sizeof(float));

  for (int j = 1; j < J; j++) 
  {
    loclap_pyramid_down(&imPyramid[j-1], &imPyramid[j], preview_scale);
    
    imLPyramid[j].width = imPyramid[j].width;
    imLPyramid[j].height = imPyramid[j].height;
    imLPyramid[j].im = dt_alloc_align(64, imPyramid[j].width * imPyramid[j].height * sizeof(float));
    if (imLPyramid[j].im == NULL)
    {
    	printf("loclap_LocalLaplacian() Error allocating memory for imLPyramid\n");
    	goto cleanup;
    }
    
    memcpy(imLPyramid[j].im, imPyramid[j].im, imPyramid[j].width * imPyramid[j].height * sizeof(float));
    
    loclap_pyramid_up(&imPyramid[j], &imLPyramid[j-1], 0, preview_scale);
  }

  // Now construct output laplacian pyramid by looking up the
  // Laplacian pyramids as a function of intensity found in the Gaussian pyramid
  // printf("Computing laplacian pyramid for input\n");
  
  for (int j = 0; j < J; j++) 
  {
    const float scale = (beta < 0) ?  
										((float)j/(J-1))*(-beta) + 1.f-(-beta) : 
										(1.0f - ((float)j/(J-1)))*beta + 1.f-beta;
    
    float *mp = imPyramid[j].im;
    float *mLP = imLPyramid[j].im;
    
#ifdef _OPENMP
#pragma omp parallel for default(none) shared(imPyramid, mLP, j, mp, minimum, maximum, pyramid) schedule(static)
#endif
    for (int i = 0; i < imPyramid[j].width*imPyramid[j].height; i++)
    {
    	const float luminance = ((mp[i] - minimum) / (maximum - minimum)) * (K-1);
    	const int K0 = MIN(MAX((int)(luminance), 0), K-2);
    	
      const int K1 = K0+1;
      const float alpha1 = luminance - K0;
      const float modified = alpha1 * pyramid[K1][j].im[i] + (1.f - alpha1) * pyramid[K0][j].im[i];

      mLP[i] = (1.f-scale) * mLP[i] + scale * modified;
    }
  }
  

  // Now collapse the output laplacian pyramid
  // printf("Collapsing laplacian pyramid down to output image\n");
  
  _loclap_image_t output = {0};
  output = imLPyramid[J-1];

  for (int j = J-2; j >= 0; j--) 
  { 
    loclap_pyramid_up(&output, &imLPyramid[j], 1, preview_scale);
    output = imLPyramid[j];
  }

  // return output
  memcpy(im_out, output.im, width * height * sizeof(float));

  
cleanup:
  for (int i = 1; i < J; i++)
  {
    if (imPyramid[i].im) dt_free_align(imPyramid[i].im);
  }

  for (int j = 0; j < J; j++)
  {
    for (int k = 0; k < K; k++)
    {
      if (pyramid[k][j].im) dt_free_align(pyramid[k][j].im);
    }
  }

  for (int i = 0; i < J; i++)
  {
    if (imLPyramid[i].im) dt_free_align(imLPyramid[i].im);
  }

#undef MAX_K
#undef MAX_J
}

